<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AZ التسويق الشامل</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
:root {
    --primary-color: #3498db;
    --secondary-color: #2980b9;
    --accent-color: #e74c3c;
    --light-color: #ecf0f1;
    --dark-color: #2c3e50;
}

* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

body {
    background: linear-gradient(to bottom, var(--primary-color) 0%, var(--primary-color) 40%, var(--light-color) 100%);
    color:#333; padding:20px; min-height:100vh;
    display:flex; flex-direction:column; align-items:center;
    overflow-x:hidden; position:relative;
    padding-bottom: 100px; /* مساحة للنص المتحرك في التذييل */
}

body::before {
    content:""; position:absolute; top:0; left:0; right:0; height:50%;
    background:
        radial-gradient(ellipse at 20% 20%, rgba(255,255,255,0.6) 10%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(255,255,255,0.5) 10%, transparent 50%),
        radial-gradient(ellipse at 40% 40%, rgba(255,255,255,0.7) 15%, transparent 60%),
        radial-gradient(ellipse at 60% 60%, rgba(255,255,255,0.4) 10%, transparent 50%);
    z-index:-1;
}

.header {
    background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
    padding:15px 20px; display:flex; justify-content:space-between; align-items:center;
    border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.15);
    position:sticky; top:20px; z-index:100; margin-bottom:30px;
    width:95%; max-width:1200px; animation: slideDown 0.8s ease-out;
    border:1px solid var(--primary-color);
}

.app-name {
    font-size:24px; font-weight:bold;
    background: linear-gradient(90deg, var(--dark-color), var(--secondary-color));
    -webkit-background-clip:text; background-clip:text; color:transparent;
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo-header {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
    box-shadow: 0 0 15px rgba(52, 152, 219, 0.7);
    border: 2px solid var(--primary-color);
    transition: all 0.5s ease;
}

.logo-header:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 0 20px rgba(52, 152, 219, 0.9);
}

.container { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px,1fr)); gap:25px; margin-bottom:30px; width:95%; max-width:1200px; }

.box {
    background: rgba(255,255,255,0.98); border-radius:20px; padding:20px;
    box-shadow:0 8px 20px rgba(52,152,219,0.25);
    transition:transform 0.3s ease; display:flex; flex-direction:column; align-items:center;
    opacity:0; transform:translateY(-50px); border:1px solid var(--primary-color);
}
.box:hover { transform:translateY(-5px); box-shadow:0 12px 25px rgba(52,152,219,0.35); }

.box-title { text-align:center; margin-bottom:20px; padding-bottom:10px; border-bottom:2px solid var(--primary-color); color:var(--dark-color); font-size:22px; width:100%; cursor:pointer; }

.buttons-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:15px; width:100%; }
.btn {
    display:flex; align-items:center; justify-content:center; gap:8px;
    padding:12px; background:linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    color:white; border:none; border-radius:12px; cursor:pointer; font-size:15px; font-weight:700;
    transition:all 0.3s ease; text-align:center; flex-direction:column; height:80px;
    opacity:0; transform:scale(0.5) rotate(15deg);
    box-shadow:0 4px 8px rgba(52,152,219,0.4); text-shadow:0 1px 2px rgba(0,0,0,0.3);
    text-decoration: none;
}
.btn:hover { transform:translateY(-3px) scale(1.05); box-shadow:0 6px 15px rgba(52,152,219,0.6); background: linear-gradient(135deg, var(--secondary-color) 0%, #2471a3 100%); }
.btn:hover i { 
    transform: rotate(15deg); 
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
}
.btn i { 
    font-size:20px; 
    filter:drop-shadow(0 1px 2px rgba(0,0,0,0.3)); 
    transition: all 0.3s ease;
}

.btn-text { font-size:13px; text-align:center; line-height:1.2; font-weight:700; color:#fff; }

/* زر التحميل المميز */
.download-btn {
    grid-column: span 2;
    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%) !important;
    position: relative;
    overflow: hidden;
}

.download-btn::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: downloadShine 3s infinite;
}

.download-btn:hover {
    background: linear-gradient(135deg, #c0392b 0%, #a93226 100%) !important;
    transform: translateY(-3px) scale(1.02);
}

/* النص المتحرك في التذييل */
.footer-marquee {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 90;
    background: rgba(255,255,255,0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 -5px 15px rgba(0,0,0,0.15);
    border-top: 2px solid var(--primary-color);
    height: 80px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.footer-marquee::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, rgba(52,152,219,0.1), transparent, rgba(52,152,219,0.1));
    z-index: 1;
    animation: shine 4s infinite;
}

.footer-text-container {
    width: 95%;
    max-width: 1200px;
    overflow: hidden;
    position: relative;
    z-index: 2;
}

.footer-scrolling-text {
    display: inline-block;
    white-space: nowrap;
    animation: scroll-text-left-to-right 25s linear infinite;
    font-weight: 700;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    font-size: 18px;
    letter-spacing: 1px;
    color: var(--dark-color);
    padding-right: 100%;
}

.footer-scrolling-text::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
    animation: line-pulse 2s infinite;
}

/* نافذة الإشعار */
.notification {
    position: fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    background:white; padding:25px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.3);
    z-index:1000; text-align:center; display:none; animation:popIn 0.5s ease-out;
    border:2px solid var(--primary-color); max-width:500px; width:90%; max-height:80vh; overflow-y:auto;
}
.notification h3 { color:var(--dark-color); margin-bottom:15px; font-size:22px; }
.notification p { margin-bottom:20px; color:#333; font-size:16px; text-align:right; line-height:1.6; }
.notification-btn { background:var(--accent-color); color:white; border:none; padding:10px 25px; border-radius:50px; cursor:pointer; font-weight:bold; transition: all 0.3s ease; }
.notification-btn:hover { background:#c0392b; transform:scale(1.05); }

.overlay { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:999; display:none; }

/* نوافذ تسجيل الدخول */
.login-modal { 
    position: fixed; top:0; left:0; right:0; bottom:0; 
    background: rgba(0,0,0,0.7); display: none; 
    justify-content: center; align-items: center; z-index:2000; 
    animation: fadeIn 0.5s ease; 
    backdrop-filter: blur(5px);
}
.login-modal.show { display:flex; }
.login-form { 
    background:white; border-radius:15px; padding:30px; 
    width:90%; max-width:400px; box-shadow:0 10px 30px rgba(0,0,0,0.3); 
    position:relative; 
    animation: modalSlideIn 0.5s ease-out;
}

@keyframes modalSlideIn {
    from { opacity:0; transform: translateY(-50px) scale(0.9); }
    to { opacity:1; transform: translateY(0) scale(1); }
}

.login-title { text-align:center; margin-bottom:20px; color:#333; }
.form-group { margin-bottom:20px; position: relative; }
.form-group label { display:block; margin-bottom:8px; font-weight:bold; color:#555; }
.form-group input { 
    width:100%; padding:12px 15px; border:1px solid #ddd; border-radius:8px; 
    font-size:16px; transition:border-color 0.3s, box-shadow 0.3s; 
}
.form-group input:focus { 
    border-color:#6a11cb; outline:none; 
    box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2);
}

.password-toggle {
    position: absolute;
    left: 15px;
    top: 42px;
    cursor: pointer;
    color: #6a11cb;
}

.login-btn { 
    display:block; width:100%; background:#6a11cb; color:white; 
    padding:12px; border-radius:8px; border:none; 
    font-size:18px; font-weight:bold; cursor:pointer; 
    transition:background 0.3s, transform 0.3s; 
}
.login-btn:hover { 
    background:#2575fc; 
    transform: translateY(-2px);
}
.close-btn { 
    position:absolute; top:10px; right:10px; background:none; border:none; 
    font-size:1.5rem; color:#666; cursor:pointer; transition:color 0.3s, transform 0.3s; 
}
.close-btn:hover { color:#000; transform: rotate(90deg); }
.message { 
    margin-top:20px; padding:10px; border-radius:5px; 
    text-align:center; display:none; 
    animation: fadeIn 0.5s ease;
}
.error { background:#ffebee; color:#d32f2f; border:1px solid #d32f2f; }
.success { background:#e8f5e9; color:#388e3c; border:1px solid #388e3c; }

/* تنسيق الإشعارات المتقدمة */
.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.toast {
    padding: 15px 20px;
    border-radius: 8px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-width: 300px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    animation: slideIn 0.3s ease;
    transition: opacity 0.3s ease;
}

.toast.success { background: #4caf50; }
.toast.error { background: #f44336; }

.toast-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.toast-icon { font-size: 20px; }

.toast-close {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 18px;
    opacity: 0.8;
    transition: opacity 0.3s;
}

.toast-close:hover { opacity: 1; }

.toast-progress {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 4px;
    background: rgba(255, 255, 255, 0.5);
    width: 100%;
    border-radius: 0 0 8px 8px;
    overflow: hidden;
}

.toast-progress-bar {
    height: 100%;
    background: white;
    animation: progressBar 5s linear forwards;
}

/* الأنيميشنات */
@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes progressBar {
    from { width: 100%; }
    to { width: 0%; }
}

@keyframes slideDown { from{transform:translateY(-100px);opacity:0;} to{transform:translateY(0);opacity:1;} }
@keyframes boxFall { to{opacity:1;transform:translateY(0);} }
@keyframes btnEntrance { to{opacity:1; transform:scale(1) rotate(0);} }
@keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
@keyframes popIn { 0%{opacity:0; transform:translate(-50%,-50%) scale(0.5);} 80%{transform:translate(-50%,-50%) scale(1.1);} 100%{opacity:1; transform:translate(-50%,-50%) scale(1);} }

@keyframes scroll-text-left-to-right {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

@keyframes downloadShine {
    0% { transform: translateX(-200%) translateY(-200%); }
    100% { transform: translateX(200%) translateY(200%); }
}

@keyframes shine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

@keyframes line-pulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}

@media(max-width:768px){.container{grid-template-columns:1fr;} .header{flex-direction:column;gap:15px;text-align:center;} .buttons-grid{grid-template-columns:repeat(2,1fr);} .btn{height:70px;} }
@media(max-width:480px){.buttons-grid{grid-template-columns:1fr;} .btn{height:60px; flex-direction:row; justify-content:flex-start; padding:10px 15px;} }
</style>
</head>
<body>

<div class="header">
    <div class="app-name">
        <img src="https://github.com/e772299420-hue/Call/blob/main/BackgroundEraser_%D9%A2%D9%A0%D9%A2%D9%A5%D9%A0%D9%A9%D9%A0%D9%A5_%D9%A0%D9%A0%D9%A3%D9%A5%D9%A0%D9%A1%D9%A0%D9%A0%D9%A7.png?raw=true" alt="شعار AZ" class="logo-header">
        AZ التسويق الشامل
    </div>
</div>

<div class="container">

    <!-- حاوية خدمات التسوق الإلكتروني -->
    <div class="box" id="box1">
        <h2 class="box-title" onclick="showProductsNotification()">
            <i class="fas fa-shopping-cart"></i> خدمات التسوق الإلكتروني
        </h2>
        <div class="buttons-grid">
            <button class="btn" onclick="openPage('1_1.html')"><i class="fas fa-shopping-bag"></i><span class="btn-text">المنتجات التجارية</span></button>
            <button class="btn" onclick="openPage('1_2.html')"><i class="fas fa-clipboard-list"></i><span class="btn-text">سوق الحراج المفتوح</span></button>
            <button class="btn" onclick="openPage('1_4.html')"><i class="fas fa-exchange-alt"></i><span class="btn-text">إعدادات سوق الحراج المفتوح</span></button>
            <button class="btn" onclick="showCommercialLogin()"><i class="fas fa-cogs"></i><span class="btn-text">الإعدادات التجارية</span></button>
            <!-- زر تحميل التطبيق الجديد -->
            <button class="btn download-btn" onclick="downloadApp()">
                <i class="fas fa-download"></i>
                <span class="btn-text">تحميل التطبيق</span>
            </button>
        </div>
    </div>

    <!-- حاوية الخدمات والمواقع التجارية -->
    <div class="box" id="box3">
        <h2 class="box-title"><i class="fas fa-building"></i> الخدمات والمواقع التجارية</h2>
        <div class="buttons-grid">
            <button class="btn" onclick="openPage('txs_1.html')"><i class="fas fa-map-marker-alt"></i><i class="fas fa-phone"></i><span class="btn-text">مواقع وأرقام أشخاص تهمك</span></button>
            <button class="btn" onclick="openPage('2_1.html')"><i class="fas fa-landmark"></i><span class="btn-text">منشأت حكومية</span></button>
            <button class="btn" onclick="openPage('2_2.html')"><i class="fas fa-hotel"></i><span class="btn-text">منشأت خاصة</span></button>
            <button class="btn" onclick="openPage('2_3.html')"><i class="fas fa-store-alt"></i><span class="btn-text">محلات تجارية</span></button>
        </div>
    </div>

    <!-- حاوية النقاشات والدردشة -->
    <div class="box" id="box4">
        <h2 class="box-title"><i class="fas fa-comments"></i> النقاشات والدردشة</h2>
        <div class="buttons-grid">
            <button class="btn" onclick="showNotification()"><i class="fas fa-globe"></i><span class="btn-text">الدردشة العامة</span></button>
            <button class="btn" onclick="showNotification()"><i class="fas fa-comment-dots"></i><span class="btn-text">الدردشة الخاصة</span></button>
            <button class="btn" onclick="showNotification()"><i class="fas fa-lightbulb"></i><span class="btn-text">المقترحات والشكاوي</span></button>
            <button class="btn" onclick="openPage('3_4.html')"><i class="fas fa-info-circle"></i><span class="btn-text">عنا</span></button>
        </div>
    </div>

    <!-- حاوية التهيئة والإعدادات -->
    <div class="box" id="box5">
        <h2 class="box-title"><i class="fas fa-cog"></i> التهيئة والإعدادات</h2>
        <div class="buttons-grid">
            <button class="btn" onclick="showNotification()"><i class="fas fa-user-plus"></i><span class="btn-text">طلب الانضمام</span></button>
            <button class="btn" onclick="showAdminLogin()"><i class="fas fa-user-cog"></i><span class="btn-text">الإعدادات الإدارية</span></button>
            <button class="btn" onclick="showNotification()"><i class="fas fa-calendar-alt"></i><span class="btn-text">الإشتراك الشهري</span></button>
            <button class="btn" onclick="showNotification()"><i class="fas fa-calendar-day"></i><span class="btn-text">الإشتراك السنوي</span></button>
        </div>
    </div>

</div>

<!-- النص المتحرك في التذييل -->
<div class="footer-marquee">
    <div class="footer-text-container">
        <div class="footer-scrolling-text" id="footerScrollingText">
            الراعي الرسمي لهذا المتجر المميز سوفت للأنظمة المحاسبية المتكاملة أول نظام محاسبي يصنع حسب الطلب للطلب والاستفسار اتصل على 772299420
        </div>
    </div>
</div>

<!-- نوافذ الإشعارات -->
<div class="overlay" id="overlay"></div>

<div class="notification" id="products-notification">
    <h3><i class="fas fa-info-circle"></i> خدمات عرض وطلب المنتجات الإلكترونية</h3>
    <p style="text-align: right; line-height: 1.5; font-size: 16px; color: #333;">
        خدمات عرض وطلب المنتجات الإلكترونية مرحبا بك عزيزنا العميل<br><br>

        أن خدمات عرض وطلب المنتجات الإلكترونية<br><br>
        
        هي خدمة الكترونية تسهل لك عملية تتبع وعرض وطلب المنتجات بجميع الأقسام والفئات<br><br>
        
        اولا خدمة عرض المنتجات هي خدمه منعزله عن خدمه طلب المنتجات حيث يقوم المتجر بترتيب عملية العرض حسب المحافظة والمنطقة والفئة/ القسم والتاجر البائع كما أنه يوفر حقل للبحث عن الأصناف أو المنتجات معينه ويتيح لك ترتيب العرض حسب التاريخ أو الاسم أو المنتج كما أنه يتيح لك ترتيب العرض حسب السعر من الأكبر للاصفر والعكس<br><br>
        
        يتم عرض المنتجات بشكل قوائم كل قائمه تحتوي على صوره المنتج واسمه وسعره ومواصفاته بحسب مدخلات التاجر البائع واسم التاجر وعنوانه عند النقر علا اسم التاجر يتم فتح شاشه تعرض بيانات التاجر البائع من ارقام هواتف وتعرض مواقع التواصل الاكترونية الخاصه بالتاجر الابئع والتي تتميز بالتالي 1- عند النقر علا زر الاتصال يتم تلقائي الاتصال بهاتف التاجر البائع 2- عند النقر علا زر المراسله يتم ارسال بيانات المنتج الحالي الى التاجر عن طريق الواتساب ومن خلالها يمكنك الاستفسار عن المنتج أو طلب خدمة التوصيل وهذه الخدمه حسب سياسه التاجر البائع 3- يمكنك فتح موقعه الاكتروني علا جوجل إن وجد 4- يمكنك فتح قانة اليوتيوب الخاصه بالتاحر البائع إن وجد 5- يمكنك فتح موقعه الفيسبوك إن وجد 6- يمكنك فتح موقعه انستجرام إن وجد 7- يمكنك فتح موقعه تويتر X إن وجد<br><br>
        
        يتم عرض موقع التاجر على خريطه جوجل<br><br>
        
        والتي تتميز 1- حساب المسافة بينك وبين التاجر 2- تحدد موقع التاجر بدقه عالية 3- تحدد مسارات الطريق للوصول للتاجر<br><br>
        
        كما يمكنك الاعجاب بالمنتجات والتعليق وقرائه التعاليق الخاصه بالاخرين كما يمكنك مشاركه رابط المنتج مع من تحب<br><br>
        
        وهي خدمه مدفوعة برسوم رمزيه ( شهريه - سنويه ) بلون ازرق وبارز<br><br>
        
        ثانيا خدمة طلب المنتجات<br><br>
        
        هي خدمه مميزه واكثر من رائعة تحمل اسم بلدي خدمة تبادل الخدمات<br><br>
        
        وتنقسم إلى<br><br>
        
        1 - الشخص الطالب والتي تمكن من طلب المنتجات أو الخدمات الاخرى بحسب طلباتك ومواصفاتك وشروطك الخاصة فتعرض علا الآخرين يمكنك اضافه رقم هاتفك للتواصل مع او يمكنك الدردشه مع الاخرين بشأن طلبك او يمكنك التواصل عبر المتجر AZ حيث تصلك اشعارات بالردود<br><br>
        
        2 - الشخص الموفر سواءا كان تاجر او طالب او عاطل او عامل فهذه تعبر باب رزق مفتوح المصدر اذا كنت عاطل عن العمل أو صاحب دخل محدود يمكنك كسب المال والمتاجره بنقره زر واحده فقط<br><br>
        
        يمكنك متابعه صفحة المتجر قسم الطلبات والاطلاع علا طلبات الآخرين وتوفيرها والربح من ذلك<br><br>
        
        من مميزاتها يستطيع الآخرين الاطلاع على الطلبات وتوفير الطلبات بحسب خبرتهم او مجالهم سواء بشكل مجاني او بمقابل مادي هذا يتم حسب الاتفاق بين الطرفين<br><br>
        
        وتعتبر هذه الخدمه مجانية لل الجميع بلون ازرق وبارز
    </p>
    <button class="notification-btn" onclick="closeProductsNotification()">موافق</button>
</div>

<!-- نموذج تسجيل الدخول للإدارة التجارية -->
<div class="login-modal" id="commercialLoginModal">
    <div class="login-form">
        <button class="close-btn" id="closeCommercialLogin"><i class="fas fa-times"></i></button>
        <h2 class="login-title">تسجيل الدخول للإدارة التجارية</h2>
        <form id="commercialLoginForm">
            <div class="form-group">
                <label for="commercialUsername">اسم المستخدم</label>
                <input type="text" id="commercialUsername" name="username" required>
            </div>
            <div class="form-group">
                <label for="commercialPassword">كلمة المرور</label>
                <input type="password" id="commercialPassword" name="password" required>
                <i class="fas fa-eye password-toggle" id="toggleCommercialPassword"></i>
            </div>
            <button type="submit" class="login-btn">تسجيل الدخول</button>
        </form>
        <div id="commercialLoginMessage" class="message"></div>
    </div>
</div>

<!-- نموذج تسجيل الدخول لإدارة الموقع -->
<div class="login-modal" id="adminLoginModal">
    <div class="login-form">
        <button class="close-btn" id="closeAdminLogin"><i class="fas fa-times"></i></button>
        <h2 class="login-title">تسجيل الدخول لإدارة الموقع</h2>
        <form id="adminLoginForm">
            <div class="form-group">
                <label for="adminUsername">اسم المستخدم</label>
                <input type="text" id="adminUsername" name="username" required>
            </div>
            <div class="form-group">
                <label for="adminPassword">كلمة المرور</label>
                <input type="password" id="adminPassword" name="password" required>
                <i class="fas fa-eye password-toggle" id="toggleAdminPassword"></i>
            </div>
            <button type="submit" class="login-btn">تسجيل الدخول</button>
        </form>
        <div id="adminLoginMessage" class="message"></div>
    </div>
</div>

<!-- حاوية الإشعارات المتقدمة -->
<div class="toast-container" id="toastContainer"></div>

<script>
// تهيئة Firebase
const firebaseConfig = {
    databaseURL: "https://chat-fat-free-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// كائن تخزين بيانات المستخدم العام
const globalUser = {
    data: null,
    
    setUserData: function(userData) {
        this.data = userData;
        localStorage.setItem('globalUserData', JSON.stringify(userData));
        console.log('تم تخزين بيانات المستخدم:', userData);
    },
    
    getUserData: function() {
        if (this.data) {
            return this.data;
        }
        
        const storedData = localStorage.getItem('globalUserData');
        if (storedData) {
            this.data = JSON.parse(storedData);
            return this.data;
        }
        
        return null;
    },
    
    getUsername: function() {
        const userData = this.getUserData();
        return userData ? userData.username : 'زائر';
    },
    
    getUserId: function() {
        const userData = this.getUserData();
        return userData ? userData.id : null;
    },
    
    isLoggedIn: function() {
        return this.getUserData() !== null;
    },
    
    logout: function() {
        this.data = null;
        localStorage.removeItem('globalUserData');
        console.log('تم تسجيل الخروج');
    }
};

// دالة إنشاء معرف فريد للتجار
function generateId(text) {
    return text.toLowerCase()
        .replace(/[أ-ي]/g, (match) => {
            const arabicToEnglish = {
                'أ': 'a', 'ب': 'b', 'ت': 't', 'ث': 'th', 'ج': 'j', 'ح': 'h', 'خ': 'kh',
                'د': 'd', 'ذ': 'th', 'ر': 'r', 'ز': 'z', 'س': 's', 'ش': 'sh', 'ص': 's',
                'ض': 'd', 'ط': 't', 'ظ': 'th', 'ع': 'a', 'غ': 'gh', 'ف': 'f', 'ق': 'q',
                'ك': 'k', 'ل': 'l', 'م': 'm', 'ن': 'n', 'ه': 'h', 'و': 'w', 'ي': 'y'
            };
            return arabicToEnglish[match] || match;
        })
        .replace(/\s+/g, '_')
        .replace(/[^\w]/g, '');
}

// دالة عرض الإشعارات المتقدمة
function showToast(message, type) {
    const toastContainer = document.getElementById('toastContainer');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    
    const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle';
    
    toast.innerHTML = `
        <div class="toast-content">
            <i class="fas ${icon} toast-icon"></i>
            <span>${message}</span>
        </div>
        <button class="toast-close">
            <i class="fas fa-times"></i>
        </button>
        <div class="toast-progress">
            <div class="toast-progress-bar"></div>
        </div>
    `;
    
    toastContainer.appendChild(toast);
    
    const closeBtn = toast.querySelector('.toast-close');
    closeBtn.addEventListener('click', () => {
        toast.style.opacity = '0';
        setTimeout(() => {
            if (toast.parentNode === toastContainer) {
                toastContainer.removeChild(toast);
            }
        }, 300);
    });
    
    setTimeout(() => {
        if (toast.parentNode === toastContainer) {
            toast.style.opacity = '0';
            setTimeout(() => {
                toastContainer.removeChild(toast);
            }, 300);
        }
    }, 5000);
}

// العناصر الأساسية للنماذج
const commercialLoginModal = document.getElementById('commercialLoginModal');
const closeCommercialLogin = document.getElementById('closeCommercialLogin');
const commercialLoginForm = document.getElementById('commercialLoginForm');
const toggleCommercialPassword = document.getElementById('toggleCommercialPassword');
const commercialPassword = document.getElementById('commercialPassword');

const adminLoginModal = document.getElementById('adminLoginModal');
const closeAdminLogin = document.getElementById('closeAdminLogin');
const adminLoginForm = document.getElementById('adminLoginForm');
const toggleAdminPassword = document.getElementById('toggleAdminPassword');
const adminPassword = document.getElementById('adminPassword');

// دوال فتح نوافذ تسجيل الدخول
function showCommercialLogin() {
    commercialLoginModal.classList.add('show');
}

function showAdminLogin() {
    adminLoginModal.classList.add('show');
}

// دالة تحميل التطبيق المحسنة
function downloadApp() {
    showToast('جاري بدء تحميل التطبيق...', 'success');
    
    try {
        // تحويل رابط Google Drive إلى رابط تحميل مباشر
        const driveUrl = 'https://drive.google.com/file/d/1kdTibT1WWxZtVwka1UpGZvdgywtpSmXS/view?usp=drivesdk';
        const fileId = driveUrl.match(/\/file\/d\/([a-zA-Z0-9_-]+)/)[1];
        const downloadUrl = `https://drive.google.com/uc?export=download&id=${fileId}`;
        
        // إنشاء عنصر رابط مخفي للتحميل
        const downloadLink = document.createElement('a');
        downloadLink.href = downloadUrl;
        downloadLink.download = 'AZ_Shopping_App.apk';
        downloadLink.style.display = 'none';
        
        // إضافة الرابط إلى الصفحة وتشغيل التحميل
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        
        // إشعار إضافي بعد ثانيتين
        setTimeout(() => {
            showToast('تم بدء تحميل التطبيق بنجاح! تحقق من مجلد التحميلات', 'success');
        }, 2000);
        
    } catch (error) {
        console.error('خطأ في تحميل التطبيق:', error);
        showToast('حدث خطأ في التحميل، يرجى المحاولة مرة أخرى', 'error');
        
        // فتح الرابط في نافذة جديدة كحل بديل
        window.open('https://drive.google.com/file/d/1kdTibT1WWxZtVwka1UpGZvdgywtpSmXS/view?usp=drivesdk', '_blank');
    }
}

// معالجات إغلاق النوافذ
closeCommercialLogin.addEventListener('click', () => {
    commercialLoginModal.classList.remove('show');
    commercialLoginForm.reset();
});

closeAdminLogin.addEventListener('click', () => {
    adminLoginModal.classList.remove('show');
    adminLoginForm.reset();
});

// معالجات إظهار/إخفاء كلمة المرور
toggleCommercialPassword.addEventListener('click', () => {
    const type = commercialPassword.getAttribute('type') === 'password' ? 'text' : 'password';
    commercialPassword.setAttribute('type', type);
    toggleCommercialPassword.classList.toggle('fa-eye');
    toggleCommercialPassword.classList.toggle('fa-eye-slash');
});

toggleAdminPassword.addEventListener('click', () => {
    const type = adminPassword.getAttribute('type') === 'password' ? 'text' : 'password';
    adminPassword.setAttribute('type', type);
    toggleAdminPassword.classList.toggle('fa-eye');
    toggleAdminPassword.classList.toggle('fa-eye-slash');
});

// معالجة تسجيل الدخول للإدارة التجارية
commercialLoginForm.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const username = document.getElementById('commercialUsername').value.trim();
    const password = document.getElementById('commercialPassword').value;
    
    try {
        if (!username || !password) {
            throw new Error('يرجى ملء جميع الحقول');
        }
        
        const merchantId = generateId(username);
        const merchantSnapshot = await database.ref('merchants').child(merchantId).once('value');
        const merchantData = merchantSnapshot.val();
        
        if (!merchantData) {
            throw new Error('اسم المستخدم أو كلمة المرور غير صحيحة');
        }
        
        if (merchantData.password !== password) {
            throw new Error('اسم المستخدم أو كلمة المرور غير صحيحة');
        }
        
        if (merchantData.status !== 'active' && merchantData.status !== 'نشط') {
            throw new Error('المستخدم تم توقيفه من قبل مسؤول النظام');
        }
        
        const userDataToStore = {
            id: merchantId,
            username: username,
            name: merchantData.name || username,
            commercialName: merchantData.commercialName || '',
            email: merchantData.email || '',
            phone: merchantData.phone || '',
            type: 'merchant',
            loginTime: new Date().toISOString()
        };
        
        globalUser.setUserData(userDataToStore);
        
        showToast('تم تسجيل الدخول بنجاح! مرحباً ' + username, 'success');
        commercialLoginForm.reset();
        
        setTimeout(() => {
            commercialLoginModal.classList.remove('show');
        }, 1000);
        
        setTimeout(() => {
            window.location.href = 'manjr_tagr_snf.html';
        }, 2000);
        
    } catch (error) {
        showToast(error.message, 'error');
    }
});

// معالجة تسجيل الدخول لإدارة الموقع
adminLoginForm.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const username = document.getElementById('adminUsername').value.trim();
    const password = document.getElementById('adminPassword').value;
    
    try {
        if (!username || !password) {
            throw new Error('يرجى ملء جميع الحقول');
        }
        
        const adminSnapshot = await database.ref('admins').child(username).once('value');
        const adminData = adminSnapshot.val();
        
        if (!adminData) {
            throw new Error('اسم المستخدم غير صحيح');
        }
        
        if (adminData.password !== password) {
            throw new Error('كلمة المرور غير صحيحة');
        }
        
        const userDataToStore = {
            id: username,
            username: username,
            name: adminData.name || username,
            type: 'admin',
            loginTime: new Date().toISOString()
        };
        
        globalUser.setUserData(userDataToStore);
        
        showToast('تم تسجيل الدخول بنجاح! مرحباً ' + username, 'success');
        adminLoginForm.reset();
        
        setTimeout(() => {
            adminLoginModal.classList.remove('show');
        }, 1000);
        
        setTimeout(() => {
            window.location.href = 'mnjr_admin.html';
        }, 2000);
        
    } catch (error) {
        showToast(error.message, 'error');
    }
});

// الوظائف الأساسية للصفحة
function openPage(pageUrl) {
    window.location.href = pageUrl;
}

function showProductsNotification() {
    document.getElementById('products-notification').style.display = 'block';
    document.getElementById('overlay').style.display = 'block';
}

function closeProductsNotification() {
    document.getElementById('products-notification').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
}

function showNotification() {
    showToast('هذه الميزة غير متاحة حالياً', 'error');
}

// معالج النقر على الخلفية لإغلاق النوافذ
document.getElementById('overlay').addEventListener('click', function() {
    closeProductsNotification();
});

// تأثيرات تحميل الصفحة
document.addEventListener('DOMContentLoaded', function() {
    const boxes = document.querySelectorAll('.box');
    const totalBoxes = boxes.length;

    boxes.forEach((box, index) => {
        const reverseIndex = totalBoxes - 1 - index;
        setTimeout(() => { 
            box.style.animation = `boxFall 0.8s ease-out forwards`; 
        }, reverseIndex * 300);
    });

    const buttons = document.querySelectorAll('.btn');
    buttons.forEach(btn => {
        const randomDelay = Math.random() * 1000 + 1500;
        setTimeout(() => { 
            btn.style.animation = `btnEntrance 0.6s ease-out forwards`; 
        }, randomDelay);
    });

    boxes.forEach(box => {
        box.addEventListener('click', function() {
            this.style.transform = 'scale(0.98)';
            setTimeout(() => { this.style.transform = ''; }, 200);
        });
    });
    
    // تغيير نص الشريط المتحرك كل 8 ثوان
    const footerScrollingText = document.getElementById('footerScrollingText');
    const texts = [
        "الراعي الرسمي لهذا المتجر المميز سوفت للأنظمة المحاسبية المتكاملة أول نظام محاسبي يصنع حسب الطلب للطلب والاستفسار اتصل على 772299420",
        "المميز سوفت للأنظمة المحاسبية المتكاملة - أول نظام محاسبي يصنع حسب الطلب - للطلب والاستفسار اتصل على 772299420",
        "للحصول على نظام محاسبي مخصص حسب طلبك، تواصل مع المميز سوفت للأنظمة المحاسبية المتكاملة - 772299420",
        "نظام محاسبي متكامل ومخصص حسب احتياجاتك - المميز سوفت - اتصل الآن 772299420"
    ];
    
    let currentTextIndex = 0;
    
    setInterval(() => {
        currentTextIndex = (currentTextIndex + 1) % texts.length;
        footerScrollingText.textContent = texts[currentTextIndex];
    }, 8000);
});
</script>

</body>
</html>
