<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    
    <!-- Open Graph Tags - Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">
    <meta property="og:site_name" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta property="og:title" id="og-title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù†ØªØ¬Ø§Øª ÙˆØ¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ©">
    <meta property="og:description" id="og-description" content="Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta property="og:image" id="og-image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    <meta property="og:url" id="og-url" content="https://e772299420-hue.github.io/Call/facebook_share.html">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitter-title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù†ØªØ¬Ø§Øª ÙˆØ¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ©">
    <meta name="twitter:description" id="twitter-description" content="Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta name="twitter:image" id="twitter-image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    
    <!-- ÙˆØµÙ Ø§Ù„ØµÙØ­Ø© -->
    <meta name="description" content="Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨">
    <meta name="keywords" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„, ÙÙŠØ³Ø¨ÙˆÙƒ, Ù…Ø´Ø§Ø±ÙƒØ©, Ù…Ù†ØªØ¬Ø§Øª, Ø¹Ø±ÙˆØ¶, ØªØ³ÙˆÙ‚">
    <meta name="author" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    
    <!-- Ø±Ø¨Ø· Ù…ÙƒØªØ¨Ø§Øª Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #1877F2;
            --secondary-color: #4267B2;
            --success-color: #42b72a;
            --dark-color: #1c1e21;
            --light-color: #f0f2f5;
            --border-radius: 12px;
            --box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .main-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
            text-align: center;
        }

        .brand-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .brand-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 20px;
            background: white;
            padding: 10px;
            border: 3px solid white;
        }

        .brand-text h1 {
            font-size: 28px;
            font-weight: 800;
            margin: 0 0 10px 0;
        }

        .brand-text p {
            opacity: 0.9;
            font-size: 16px;
            margin: 0;
        }

        /* Ù…Ù†ØªØ¬ Ù…ÙØ±Ø¯ (Ø¹Ù†Ø¯ ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©) */
        .single-product-view {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            display: none;
        }

        .product-hero-image {
            width: 100%;
            height: 400px;
            overflow: hidden;
            position: relative;
        }

        .hero-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #f8f9fa;
            display: block;
        }

        .product-details {
            padding: 30px;
        }

        .product-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--dark-color);
            margin: 0 0 20px 0;
            line-height: 1.3;
        }

        .product-price {
            font-size: 36px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .product-description {
            font-size: 18px;
            line-height: 1.8;
            color: #495057;
            margin-bottom: 30px;
            white-space: pre-line;
        }

        .merchant-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .merchant-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }

        .merchant-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .share-buttons {
                grid-template-columns: 1fr;
            }
        }

        .share-btn {
            padding: 18px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .btn-facebook {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .all-products-view {
            display: block;
        }

        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .products-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
            margin: 0;
        }

        .products-count {
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }

        /* ÙÙ„ØªØ±Ø© */
        .filter-section {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 14px;
        }

        .filter-input, .filter-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5eb;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            background: white;
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(24, 119, 242, 0.1);
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .filter-btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-apply {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-apply:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(24, 119, 242, 0.3);
        }

        .btn-reset {
            background: #e9ecef;
            color: #495057;
        }

        .btn-reset:hover {
            background: #dee2e6;
            transform: translateY(-2px);
        }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
        .product-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .card-image-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
            background: #f8f9fa;
        }

        .card-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.5s ease;
            display: block;
        }

        .product-card:hover .card-image {
            transform: scale(1.05);
        }

        .card-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin: 0 0 10px 0;
            line-height: 1.4;
        }

        .card-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .card-description {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 20px;
            flex: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-share-btn {
            padding: 12px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
            margin-top: auto;
        }

        .card-share-btn:hover {
            background: linear-gradient(135deg, #166fe5, #29487d);
            transform: translateY(-2px);
        }

        /* Ø§Ù„ÙÙˆØªØ± */
        .main-footer {
            background: var(--dark-color);
            color: white;
            padding: 40px 20px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            text-align: center;
            margin-top: 50px;
        }

        .footer-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 20px;
        }

        .back-home {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 30px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .back-home:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
        }

        /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 10000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            max-width: 400px;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .notification.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f0f2f5;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .error-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="main-header">
            <div class="brand-section">
                <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                     alt="Ø´Ø¹Ø§Ø± AZ" 
                     class="brand-logo">
                <div class="brand-text">
                    <h1>AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                    <p>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨</p>
                </div>
            </div>
        </header>

        <!-- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯ (Ø¹Ù†Ø¯ ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©) -->
        <div id="singleProductView" class="single-product-view">
            <div class="product-hero-image">
                <img id="singleProductImage" class="hero-image" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
            </div>
            <div class="product-details">
                <h1 id="singleProductTitle" class="product-title"></h1>
                <div id="singleProductPrice" class="product-price"></div>
                <div id="singleProductDescription" class="product-description"></div>
                
                <div class="merchant-info">
                    <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                         alt="Ø§Ù„ØªØ§Ø¬Ø±" 
                         class="merchant-avatar">
                    <div>
                        <div class="merchant-name" id="merchantName"></div>
                        <div id="merchantLocation"></div>
                    </div>
                </div>

                <div class="share-buttons">
                    <button class="share-btn btn-facebook" onclick="shareCurrentProduct('facebook')">
                        <i class="fab fa-facebook-f"></i>
                        Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
                    </button>
                    <button class="share-btn btn-whatsapp" onclick="shareCurrentProduct('whatsapp')">
                        <i class="fab fa-whatsapp"></i>
                        Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
                    </button>
                </div>
            </div>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div id="allProductsView" class="all-products-view">
            <!-- Ù‚Ø³Ù… Ø§Ù„ÙÙ„ØªØ±Ø© -->
            <section class="filter-section">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label class="filter-label">
                            <i class="fas fa-search"></i>
                            Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬
                        </label>
                        <input type="text" 
                               id="searchInput" 
                               class="filter-input" 
                               placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£Ùˆ Ø§Ù„ØªØ§Ø¬Ø±...">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">
                            <i class="fas fa-tags"></i>
                            Ø§Ù„ÙØ¦Ø©
                        </label>
                        <select id="categoryFilter" class="filter-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">
                            <i class="fas fa-store"></i>
                            Ø§Ù„ØªØ§Ø¬Ø±
                        </label>
                        <select id="merchantFilter" class="filter-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>
                        </select>
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="filter-btn btn-apply" onclick="applyFilters()">
                        <i class="fas fa-filter"></i>
                        ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
                    </button>
                    <button class="filter-btn btn-reset" onclick="resetFilters()">
                        <i class="fas fa-redo"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                </div>
            </section>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
            <div class="products-header">
                <h2 class="products-title">
                    <i class="fas fa-box-open"></i>
                    Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                </h2>
                <div class="products-count" id="productsCount">0 Ù…Ù†ØªØ¬</div>
            </div>

            <div id="productsContainer">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ÙÙˆØªØ± -->
    <footer class="main-footer">
        <div class="container">
            <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                 alt="Ø´Ø¹Ø§Ø± AZ" 
                 class="footer-logo">
            <p>Â© 2024 AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
            <p>Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„ØªÙ„Ø¨ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ØªØ³ÙˆÙ‚ÙŠØ©</p>
            <button onclick="window.location.href='az_suq.html'" class="back-home">
                <i class="fas fa-arrow-left"></i>
                Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </button>
        </div>
    </footer>

    <script>
        // ==========================================
        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
        // ==========================================
        const firebaseConfig = {
            databaseURL: "https://chat-fat-free-default-rtdb.firebaseio.com/"
        };

        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ù†Ø¬Ø§Ø­');
            }
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase:", error);
            showNotification('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
        }

        const db = firebase.database();

        // ==========================================
        // ğŸ“¦ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        let allProducts = [];
        let allMerchants = [];
        let allCategories = [];
        let currentProductForShare = null;
        let isSingleProductView = false;

        // ==========================================
        // ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø¹Ø±Ù Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (productId) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø¹Ø±Ù Ù…Ù†ØªØ¬ØŒ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
                isSingleProductView = true;
                document.getElementById('allProductsView').style.display = 'none';
                loadAndDisplaySingleProduct(productId);
            } else {
                // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                isSingleProductView = false;
                loadAllData();
            }
            
            // ØªØ­Ø¯ÙŠØ« Open Graph Tags Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            updateOpenGraphTags();
        });

        // ==========================================
        // ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        // ==========================================
        async function loadAllData() {
            try {
                showLoading();
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase
                const [productsSnap, merchantsSnap, categoriesSnap] = await Promise.all([
                    db.ref("products").once("value"),
                    db.ref("merchants").once("value"),
                    db.ref("categories").once("value")
                ]);

                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                allProducts = convertFirebaseData(productsSnap.val()) || [];
                allMerchants = convertFirebaseData(merchantsSnap.val()) || [];
                allCategories = convertFirebaseData(categoriesSnap.val()) || [];

                console.log('ğŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', {
                    products: allProducts.length,
                    merchants: allMerchants.length,
                    categories: allCategories.length
                });

                // ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© ÙÙ‚Ø·
                const activeProducts = filterActiveProducts(allProducts);
                
                // ØªØ¹Ø¨Ø¦Ø© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„Ø§ØªØ±
                populateFilters(activeProducts);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                displayProducts(activeProducts);

            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
            }
        }

        // ==========================================
        // ğŸ”„ ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Firebase Ø¥Ù„Ù‰ Ù…ØµÙÙˆÙØ©
        // ==========================================
        function convertFirebaseData(firebaseData) {
            if (!firebaseData) return [];
            try {
                return Object.entries(firebaseData).map(([id, data]) => {
                    return { id, ...data };
                });
            } catch (e) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", e);
                return [];
            }
        }

        // ==========================================
        // ğŸª ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
        // ==========================================
        function filterActiveProducts(products) {
            return products.filter(product => {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªØ§Ø¬Ø±
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (!merchant) return false;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø¬Ø± Ù†Ø´Ø·
                const isActive = merchant.status === "active" || 
                                merchant.status === "Ù†Ø´Ø·" || 
                                merchant.status === "Active";
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø¬Ø±
                const isMerchant = merchant.job === "ØªØ§Ø¬Ø±" || 
                                  merchant.type === "ØªØ§Ø¬Ø±" ||
                                  merchant.job === "ØªØ§Ø¬Ø±Ù‡" ||
                                  merchant.role === "ØªØ§Ø¬Ø±";
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø³Ù… Ù„Ù„Ù…Ù†ØªØ¬
                const hasName = product.name && product.name.trim() !== '';
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙˆØ± Ù„Ù„Ù…Ù†ØªØ¬
                const hasImages = extractProductImages(product).length > 0;
                
                return isActive && isMerchant && hasName && hasImages;
            });
        }

        // ==========================================
        // ğŸ–¼ï¸ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø­Ù‚Ù„ imageUrls
        // ==========================================
        function extractProductImages(product) {
            const images = [];
            
            console.log('ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬:', product.id);
            
            // Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: imageUrls
            if (product.imageUrls) {
                console.log('ğŸ“¸ ÙˆØ¬Ø¯Øª Ø­Ù‚Ù„ imageUrls:', product.imageUrls);
                
                if (Array.isArray(product.imageUrls)) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØµÙÙˆÙØ©
                    product.imageUrls.forEach(img => {
                        if (img && typeof img === 'string' && img.trim() !== '') {
                            images.push(img.trim());
                        }
                    });
                } else if (typeof product.imageUrls === 'string') {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ØµØ§Ù‹ (Ù…ÙØµÙˆÙ„ Ø¨ÙÙˆØ§ØµÙ„)
                    const splitImages = product.imageUrls
                        .split(/[,\n]/)
                        .map(img => img.trim())
                        .filter(img => img !== '');
                    
                    images.push(...splitImages);
                }
            }
            
            // Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø®Ø±Ù‰ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
            const otherImageFields = ['image', 'images', 'imageUrl', 'photo', 'photos', 'ØµÙˆØ±Ø©', 'ØµÙˆØ±'];
            
            otherImageFields.forEach(field => {
                if (product[field]) {
                    console.log(`ğŸ“¸ ÙˆØ¬Ø¯Øª Ø­Ù‚Ù„ ${field}:`, product[field]);
                    
                    if (Array.isArray(product[field])) {
                        product[field].forEach(img => {
                            if (img && typeof img === 'string' && img.trim() !== '') {
                                const trimmedImg = img.trim();
                                if (!images.includes(trimmedImg)) {
                                    images.push(trimmedImg);
                                }
                            }
                        });
                    } else if (typeof product[field] === 'string') {
                        const splitImages = product[field]
                            .split(/[,\n]/)
                            .map(img => img.trim())
                            .filter(img => img !== '');
                        
                        splitImages.forEach(img => {
                            if (!images.includes(img)) {
                                images.push(img);
                            }
                        });
                    }
                }
            });
            
            console.log(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${images.length} ØµÙˆØ±Ø© Ù„Ù„Ù…Ù†ØªØ¬ ${product.id}:`, images);
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØµÙˆØ±ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            if (images.length === 0) {
                images.push('https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png');
            }
            
            return images;
        }

        // ==========================================
        // ğŸ”— ØªØ­ÙˆÙŠÙ„ Ø±Ø§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙ Ø¥Ù„Ù‰ ØµÙŠØºØ© ØµØ§Ù„Ø­Ø©
        // ==========================================
        function formatGoogleDriveUrl(url) {
            if (!url || typeof url !== 'string') {
                return 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
            }
            
            url = url.trim();
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙ
            if (url.includes('drive.google.com')) {
                console.log('ğŸ”— Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±Ø§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙ:', url);
                
                let fileId = '';
                
                // Ù†Ù…Ø· 1: https://drive.google.com/file/d/FILE_ID/view
                if (url.includes('/d/')) {
                    const match = url.match(/\/d\/([^\/]+)/);
                    if (match && match[1]) {
                        fileId = match[1];
                    }
                }
                // Ù†Ù…Ø· 2: https://drive.google.com/open?id=FILE_ID
                else if (url.includes('id=')) {
                    const params = new URLSearchParams(url.split('?')[1] || '');
                    fileId = params.get('id');
                }
                // Ù†Ù…Ø· 3: https://drive.google.com/uc?id=FILE_ID
                else if (url.includes('uc?id=')) {
                    const match = url.match(/uc\?id=([^&]+)/);
                    if (match && match[1]) {
                        fileId = match[1];
                    }
                }
                // Ù†Ù…Ø· 4: FILE_ID Ù…Ø¨Ø§Ø´Ø±Ø© (33 Ø­Ø±Ù)
                else if (url.length === 33 && !url.includes('/') && !url.includes('?')) {
                    fileId = url;
                }
                
                if (fileId) {
                    console.log(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù„Ù: ${fileId}`);
                    
                    // Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ù‡Ø°Ø§ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ Ù„ÙÙŠØ³Ø¨ÙˆÙƒ
                    const directUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;
                    console.log(`ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±: ${directUrl}`);
                    return directUrl;
                } else {
                    console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù„Ù ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·');
                }
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù„ÙŠØ³ Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙØŒ Ø¥Ø±Ø¬Ø§Ø¹Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ
            console.log('ğŸ”— Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ:', url);
            return url;
        }

        // ==========================================
        // ğŸ“‹ ØªØ¹Ø¨Ø¦Ø© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function populateFilters(products) {
            // Ø§Ù„ÙØ¦Ø§Øª
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>';
            
            const categoriesMap = new Map();
            products.forEach(product => {
                if (product.categoryId) {
                    const category = allCategories.find(c => c.id === product.categoryId);
                    if (category && category.name) {
                        categoriesMap.set(category.id, category.name);
                    }
                }
            });
            
            categoriesMap.forEach((name, id) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = name;
                categoryFilter.appendChild(option);
            });

            // Ø§Ù„ØªØ¬Ø§Ø±
            const merchantFilter = document.getElementById('merchantFilter');
            merchantFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>';
            
            const merchantsMap = new Map();
            products.forEach(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (merchant && merchant.name) {
                    merchantsMap.set(merchant.id, merchant.name);
                }
            });
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ¬Ø§Ø± Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹
            const sortedMerchants = Array.from(merchantsMap.entries())
                .sort((a, b) => a[1].localeCompare(b[1]));
            
            sortedMerchants.forEach(([id, name]) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = name;
                merchantFilter.appendChild(option);
            });
        }

        // ==========================================
        // ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        // ==========================================
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            const countElement = document.getElementById('productsCount');
            
            if (!products || products.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open fa-4x" style="color: #dee2e6; margin-bottom: 20px;"></i>
                        <h3 style="color: #6c757d;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</h3>
                        <p style="color: #adb5bd;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                        <button onclick="resetFilters()" style="padding: 12px 30px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px;">
                            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                        </button>
                    </div>
                `;
                countElement.textContent = '0 Ù…Ù†ØªØ¬';
                return;
            }

            const productsHTML = products.map(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                const category = allCategories.find(c => c.id === product.categoryId);
                const images = extractProductImages(product);
                const mainImage = formatGoogleDriveUrl(images[0]);
                const price = product.price ? 
                    `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                    'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                
                const shortDescription = product.description ? 
                    (product.description.length > 120 ? 
                        product.description.substring(0, 120) + '...' : 
                        product.description) : 
                    'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ù†ØªØ¬';
                
                return `
                    <div class="product-card" data-product-id="${product.id}">
                        <div class="card-image-container">
                            <img src="${mainImage}" 
                                 alt="${product.name || 'Ù…Ù†ØªØ¬'}" 
                                 class="card-image"
                                 loading="lazy"
                                 onerror="this.onerror=null; this.src='https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png'">
                        </div>
                        <div class="card-content">
                            <h3 class="card-title">${product.name || 'Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</h3>
                            <div class="card-price">
                                <i class="fas fa-money-bill-wave"></i>
                                ${price}
                            </div>
                            <p class="card-description">${shortDescription}</p>
                            <button class="card-share-btn" onclick="prepareAndShareProduct('${product.id}')">
                                <i class="fas fa-share-alt"></i>
                                Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="products-grid">
                    ${productsHTML}
                </div>
            `;
            
            countElement.textContent = `${products.length} Ù…Ù†ØªØ¬`;
        }

        // ==========================================
        // ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryId = document.getElementById('categoryFilter').value;
            const merchantId = document.getElementById('merchantFilter').value;

            const activeProducts = filterActiveProducts(allProducts);
            
            let filtered = activeProducts.filter(product => {
                // Ø§Ù„Ø¨Ø­Ø«
                if (searchTerm) {
                    const productName = (product.name || '').toLowerCase();
                    const productDesc = (product.description || '').toLowerCase();
                    const merchant = allMerchants.find(m => m.id === product.userId);
                    const merchantName = (merchant?.name || '').toLowerCase();
                    
                    if (!productName.includes(searchTerm) && 
                        !productDesc.includes(searchTerm) && 
                        !merchantName.includes(searchTerm)) {
                        return false;
                    }
                }

                // Ø§Ù„ÙØ¦Ø©
                if (categoryId && product.categoryId !== categoryId) {
                    return false;
                }

                // Ø§Ù„ØªØ§Ø¬Ø±
                if (merchantId && product.userId !== merchantId) {
                    return false;
                }

                return true;
            });

            displayProducts(filtered);
        }

        // ==========================================
        // ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('merchantFilter').value = '';
            
            const activeProducts = filterActiveProducts(allProducts);
            displayProducts(activeProducts);
            
            showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±', 'success');
        }

        // ==========================================
        // ğŸ¯ ØªØ­Ø¶ÙŠØ± ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬
        // ==========================================
        function prepareAndShareProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            currentProductForShare = product;
            const shareUrl = `${window.location.origin}${window.location.pathname}?productId=${productId}`;
            
            // ØªØ­Ø¯ÙŠØ« Open Graph Tags Ø£ÙˆÙ„Ø§Ù‹
            updateOpenGraphTagsForProduct(product);
            
            // Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Facebook
            shareProductOnFacebook(product, shareUrl);
        }

        // ==========================================
        // ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« Open Graph Tags Ù„Ù„Ù…Ù†ØªØ¬
        // ==========================================
        function updateOpenGraphTagsForProduct(product) {
            const images = extractProductImages(product);
            const mainImage = formatGoogleDriveUrl(images[0]);
            const title = product.name || 'Ù…Ù†ØªØ¬ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const description = product.description || 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const url = `${window.location.origin}${window.location.pathname}?productId=${product.id}`;
            
            console.log('ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« Open Graph Tags:', {
                title,
                description,
                image: mainImage,
                url
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Open Graph
            document.getElementById('og-title').setAttribute('content', title);
            document.getElementById('og-description').setAttribute('content', description);
            document.getElementById('og-image').setAttribute('content', mainImage);
            document.getElementById('og-url').setAttribute('content', url);
            
            // ØªØ­Ø¯ÙŠØ« Twitter Card
            document.getElementById('twitter-title').setAttribute('content', title);
            document.getElementById('twitter-description').setAttribute('content', description);
            document.getElementById('twitter-image').setAttribute('content', mainImage);
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
            document.title = title + ' - AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            
            // Ø¥Ø¶Ø§ÙØ© ÙˆØ³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©
            updateAdditionalMetaTags();
        }

        // ==========================================
        // ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« ÙˆØ³ÙˆÙ… Meta Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
        // ==========================================
        function updateAdditionalMetaTags() {
            // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±
            const metaTags = [
                { property: 'og:image:secure_url', content: document.getElementById('og-image').getAttribute('content') },
                { property: 'og:image:alt', content: document.getElementById('og-title').getAttribute('content') },
                { name: 'twitter:image:alt', content: document.getElementById('og-title').getAttribute('content') }
            ];
            
            metaTags.forEach(tag => {
                let metaElement = document.querySelector(`meta[property="${tag.property}"]`) || 
                                 document.querySelector(`meta[name="${tag.property}"]`);
                
                if (!metaElement) {
                    metaElement = document.createElement('meta');
                    if (tag.property.startsWith('og:')) {
                        metaElement.setAttribute('property', tag.property);
                    } else {
                        metaElement.setAttribute('name', tag.property);
                    }
                    document.head.appendChild(metaElement);
                }
                
                metaElement.setAttribute('content', tag.content);
            });
        }

        // ==========================================
        // ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« Open Graph Tags Ø§Ù„Ø¹Ø§Ù…Ø©
        // ==========================================
        function updateOpenGraphTags() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (!productId) {
                // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                const defaultImage = 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
                const defaultTitle = 'AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª';
                const defaultDescription = 'Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨';
                const defaultUrl = window.location.href;
                
                document.getElementById('og-title').setAttribute('content', defaultTitle);
                document.getElementById('og-description').setAttribute('content', defaultDescription);
                document.getElementById('og-image').setAttribute('content', defaultImage);
                document.getElementById('og-url').setAttribute('content', defaultUrl);
                
                document.getElementById('twitter-title').setAttribute('content', defaultTitle);
                document.getElementById('twitter-description').setAttribute('content', defaultDescription);
                document.getElementById('twitter-image').setAttribute('content', defaultImage);
            }
        }

        // ==========================================
        // ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Facebook
        // ==========================================
        function shareProductOnFacebook(product, shareUrl) {
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const facebookGroupUrl = 'https://facebook.com/groups/1650698542573379/';
            
            // Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ© Facebook
            const encodedUrl = encodeURIComponent(shareUrl);
            const encodedQuote = encodeURIComponent(productName);
            const shareUrlFinal = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}&quote=${encodedQuote}&hashtag=%23AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„`;
            
            console.log('ğŸ“¤ Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ© Facebook:', shareUrlFinal);
            
            // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            window.open(shareUrlFinal, '_blank', 'width=700,height=600');
            
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ Facebook Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'info');
        }

        // ==========================================
        // ğŸ“± Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ WhatsApp
        // ==========================================
        function shareProductOnWhatsApp(product, shareUrl) {
            const merchant = allMerchants.find(m => m.id === product.userId);
            
            const message = `ğŸ›ï¸ ${product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹'} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${product.price ? `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²'}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø±'}

ğŸ“ ${product.description || 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„'}

ğŸ”— ${shareUrl}

#AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„ #ØªØ³ÙˆÙ‚`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ WhatsApp Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'info');
        }

        // ==========================================
        // ğŸ¯ ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ù…Ù†ØªØ¬ Ù…ÙØ±Ø¯
        // ==========================================
        async function loadAndDisplaySingleProduct(productId) {
            try {
                showLoading();
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù…Ù„Ø©
                let product = allProducts.find(p => p.id === productId);
                
                if (!product && allProducts.length === 0) {
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø­Ù…Ù„Ø©
                    const [productsSnap, merchantsSnap, categoriesSnap] = await Promise.all([
                        db.ref("products").once("value"),
                        db.ref("merchants").once("value"),
                        db.ref("categories").once("value")
                    ]);

                    allProducts = convertFirebaseData(productsSnap.val()) || [];
                    allMerchants = convertFirebaseData(merchantsSnap.val()) || [];
                    allCategories = convertFirebaseData(categoriesSnap.val()) || [];
                    
                    product = allProducts.find(p => p.id === productId);
                }
                
                if (!product) {
                    // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙÙŠ Firebase
                    const productSnap = await db.ref(`products/${productId}`).once('value');
                    if (productSnap.exists()) {
                        product = { id: productId, ...productSnap.val() };
                        allProducts.push(product);
                    }
                }
                
                if (!product) {
                    showError('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                    return;
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
                displaySingleProduct(product);
                
                // ØªØ­Ø¯ÙŠØ« Open Graph Tags
                updateOpenGraphTagsForProduct(product);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬:', error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬');
            }
        }

        // ==========================================
        // ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
        // ==========================================
        function displaySingleProduct(product) {
            const merchant = allMerchants.find(m => m.id === product.userId);
            const category = allCategories.find(c => c.id === product.categoryId);
            const images = extractProductImages(product);
            const mainImage = formatGoogleDriveUrl(images[0]);
            const price = product.price ? 
                `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            
            console.log('ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯:', {
                productId: product.id,
                imageUrl: mainImage,
                hasMerchant: !!merchant
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù†ØªØ¬
            const singleProductImage = document.getElementById('singleProductImage');
            singleProductImage.src = mainImage;
            singleProductImage.alt = product.name || 'Ù…Ù†ØªØ¬';
            singleProductImage.onerror = function() {
                this.onerror = null;
                this.src = 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
            };
            
            document.getElementById('singleProductTitle').textContent = product.name || 'Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…';
            document.getElementById('singleProductPrice').textContent = price;
            document.getElementById('singleProductDescription').textContent = product.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ù†ØªØ¬';
            
            if (merchant) {
                document.getElementById('merchantName').textContent = merchant.name || merchant.username || 'ØªØ§Ø¬Ø±';
                document.getElementById('merchantLocation').textContent = merchant.governorate || merchant.city || '';
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
            document.getElementById('singleProductView').style.display = 'block';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            document.getElementById('productsContainer').innerHTML = '';
        }

        // ==========================================
        // ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø­Ø§Ù„ÙŠ
        // ==========================================
        function shareCurrentProduct(platform) {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (!productId) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }
            
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }
            
            const shareUrl = `${window.location.origin}${window.location.pathname}?productId=${productId}`;
            
            if (platform === 'facebook') {
                shareProductOnFacebook(product, shareUrl);
            } else if (platform === 'whatsapp') {
                shareProductOnWhatsApp(product, shareUrl);
            }
        }

        // ==========================================
        // ğŸ”” Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        // ==========================================
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ==========================================
        // â³ Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        // ==========================================
        function showLoading() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
                </div>
            `;
        }

        // ==========================================
        // âŒ Ø¹Ø±Ø¶ Ø®Ø·Ø£
        // ==========================================
        function showError(message) {
            const container = document.getElementById('productsContainer');
            container.innerHTML = `
                <div class="error-state">
                    <i class="fas fa-exclamation-triangle fa-4x" style="color: #e74c3c; margin-bottom: 20px;"></i>
                    <h3 style="color: #c0392b;">Ø­Ø¯Ø« Ø®Ø·Ø£</h3>
                    <p style="color: #7f8c8d;">${message}</p>
                    <button onclick="location.reload()" style="padding: 12px 30px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px;">
                        <i class="fas fa-redo"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
                    </button>
                </div>
            `;
        }

        // ==========================================
        // ğŸŒ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
        // ==========================================
        window.prepareAndShareProduct = prepareAndShareProduct;
        window.shareCurrentProduct = shareCurrentProduct;
        window.applyFilters = applyFilters;
        window.resetFilters = resetFilters;

        console.log('ğŸ‰ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ù†Ø¬Ø§Ø­');
    </script>
</body>
    </html>
