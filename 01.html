<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ</title>
    
    <!-- Open Graph Tags Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <meta property="og:title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù†ØµØ© Ø§Ù„ØªØ³ÙˆÙ‚ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©">
    <meta property="og:description" content="Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ">
    <meta property="og:image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    <meta property="og:url" content="https://e772299420-hue.github.io/facebook_share.html">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">
    <meta property="og:site_name" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª">
    <meta name="twitter:description" content="Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    
    <!-- Ø¥Ø¶Ø§ÙØ© ÙˆØµÙ Ù„Ù„ØµÙØ­Ø© -->
    <meta name="description" content="Ù…Ù†ØµØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù†ØªØ¬Ø§Øª AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ - Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡">
    <meta name="keywords" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„, Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù†ØªØ¬Ø§Øª, ÙÙŠØ³Ø¨ÙˆÙƒ, ØªØ³ÙˆÙŠÙ‚ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ, ØªØ³ÙˆÙ‚, Ù…Ù†ØªØ¬Ø§Øª, Ø¹Ø±ÙˆØ¶, Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙˆØ§ØµÙ„">
    <meta name="author" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    
    <!-- Ø±Ø¨Ø· Ù…ÙƒØªØ¨Ø§Øª Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- Ø±Ø¨Ø· Font Awesome Ù„Ù„Ø±Ù…ÙˆØ² -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Ø±Ø¨Ø· Bootstrap Ù„Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #1877F2;
            --secondary-color: #4267B2;
            --success-color: #42b72a;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --dark-color: #1c1e21;
            --light-color: #f0f2f5;
            --background-color: #ffffff;
            --text-color: #333;
            --border-radius: 12px;
            --box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding-top: 20px;
        }

        /* ==========================================
           ğŸ¯ Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù…ÙŠØ²
           ========================================== */
        .main-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 0;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .main-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .brand-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .brand-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 20px;
            background: white;
            padding: 10px;
            border: 3px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .brand-text {
            flex: 1;
        }

        .brand-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 5px;
            color: white;
        }

        .brand-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .facebook-platform {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 15px 25px;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .facebook-platform i {
            font-size: 32px;
            color: white;
        }

        .facebook-platform span {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        /* ==========================================
           ğŸ¯ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
           ========================================== */
        .filter-section {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            margin-bottom: 30px;
        }

        .filter-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-title i {
            color: var(--primary-color);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .filter-group {
            margin-bottom: 0;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 14px;
        }

        .form-control, .form-select {
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            padding: 12px 15px;
            font-size: 14px;
            transition: var(--transition);
            background: white;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(24, 119, 242, 0.15);
        }

        .search-box {
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        .search-box .form-control {
            padding-right: 45px;
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn {
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(24, 119, 242, 0.3);
        }

        .btn-outline-secondary {
            border: 2px solid #e1e5eb;
            color: #6c757d;
            background: white;
        }

        .btn-outline-secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            background: white;
        }

        /* ==========================================
           ğŸ¯ Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
           ========================================== */
        .products-section {
            margin-bottom: 50px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary-color);
        }

        .products-count {
            background: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
        }

        /* ==========================================
           ğŸ¯ Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
           ========================================== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ==========================================
           ğŸ¯ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
           ========================================== */
        .product-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            border: 2px solid transparent;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .product-image-container {
            position: relative;
            width: 100%;
            height: 250px;
            overflow: hidden;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-badges {
            position: absolute;
            top: 15px;
            left: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .product-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            color: white;
        }

        .badge-offer {
            background: linear-gradient(135deg, #ff9f43, #ff6b6b);
        }

        .badge-new {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .badge-featured {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .product-content {
            padding: 25px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 12px;
            line-height: 1.4;
            min-height: 56px;
        }

        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f2f5;
        }

        .product-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .product-category {
            background: #f0f2f5;
            color: #65676b;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .product-description {
            color: #65676b;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 20px;
            flex: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .merchant-info {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .merchant-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            padding: 2px;
        }

        .merchant-details {
            flex: 1;
        }

        .merchant-name {
            font-weight: 700;
            color: var(--dark-color);
            font-size: 15px;
            margin-bottom: 3px;
        }

        .merchant-location {
            font-size: 12px;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* ==========================================
           ğŸ¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
           ========================================== */
        .share-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: auto;
        }

        .btn-facebook-share {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .btn-facebook-share::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .btn-facebook-share:hover::before {
            left: 100%;
        }

        .btn-facebook-share:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(24, 119, 242, 0.4);
        }

        .btn-whatsapp-share {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 16px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            border: none;
            cursor: pointer;
        }

        .btn-whatsapp-share:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
        }

        /* ==========================================
           ğŸ¯ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
           ========================================== */
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .share-modal.active {
            display: flex;
        }

        .share-modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .share-modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }

        .share-modal-title {
            font-size: 26px;
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .share-modal-subtitle {
            opacity: 0.9;
            font-size: 16px;
            font-weight: 500;
        }

        .share-modal-close {
            position: absolute;
            top: 20px;
            left: 25px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 20px;
        }

        .share-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .share-modal-body {
            padding: 30px;
        }

        .share-preview-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
        }

        .share-preview-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .share-preview-title i {
            color: var(--primary-color);
        }

        .share-preview {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: 1px solid #dee2e6;
        }

        .share-preview-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-bottom: 3px solid var(--primary-color);
        }

        .share-preview-content {
            padding: 20px;
        }

        .share-preview-text {
            font-size: 16px;
            line-height: 1.6;
            color: #495057;
            margin-bottom: 15px;
            white-space: pre-line;
        }

        .share-url-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 2px dashed #dee2e6;
        }

        .share-url-label {
            font-size: 14px;
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 8px;
            display: block;
        }

        .share-url {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: var(--primary-color);
            word-break: break-all;
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .share-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 25px;
        }

        @media (max-width: 576px) {
            .share-actions {
                grid-template-columns: 1fr;
            }
        }

        .btn-copy {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
        }

        .btn-copy:hover {
            background: linear-gradient(135deg, #5a6268, #343a40);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-share-facebook {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-share-facebook:hover {
            background: linear-gradient(135deg, #166fe5, #29487d);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(24, 119, 242, 0.3);
        }

        .btn-share-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .btn-share-whatsapp:hover {
            background: linear-gradient(135deg, #1da851, #0e7d5f);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }

        .share-modal-footer {
            padding: 20px 30px;
            text-align: center;
            color: #6c757d;
            font-size: 14px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        /* ==========================================
           ğŸ¯ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ø£Ø®Ø·Ø§Ø¡
           ========================================== */
        .loading-state {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f0f2f5;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 18px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .error-state {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .error-icon {
            font-size: 60px;
            color: var(--danger-color);
            margin-bottom: 20px;
        }

        .error-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 15px;
        }

        .error-message {
            color: #6c757d;
            font-size: 16px;
            margin-bottom: 25px;
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .empty-icon {
            font-size: 80px;
            color: #dee2e6;
            margin-bottom: 25px;
        }

        .empty-title {
            font-size: 24px;
            font-weight: 700;
            color: #6c757d;
            margin-bottom: 15px;
        }

        .empty-message {
            color: #adb5bd;
            font-size: 16px;
            margin-bottom: 30px;
        }

        /* ==========================================
           ğŸ¯ Ø§Ù„ÙÙˆØªØ±
           ========================================== */
        .main-footer {
            background: var(--dark-color);
            color: white;
            padding: 40px 0;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            margin-top: 60px;
        }

        .footer-content {
            text-align: center;
        }

        .footer-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 20px;
        }

        .footer-text {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .back-to-home {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 30px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .back-to-home:hover {
            background: transparent;
            border-color: var(--primary-color);
            transform: translateY(-3px);
        }

        /* ==========================================
           ğŸ¯ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¹Ø§Ù…Ø©
           ========================================== */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 10000;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s;
            max-width: 400px;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .notification.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .notification.warning {
            background: linear-gradient(135deg, #f39c12, #d35400);
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="brand-section">
                    <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                         alt="Ø´Ø¹Ø§Ø± AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„" 
                         class="brand-logo">
                    <div class="brand-text">
                        <h1 class="brand-title">AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                        <p class="brand-subtitle">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ - ÙˆØµÙ„ Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø¥Ù„Ù‰ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ</p>
                    </div>
                    <div class="facebook-platform">
                        <i class="fab fa-facebook-f"></i>
                        <span>Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠØ³Ø¨ÙˆÙƒ</span>
                    </div>
                </div>
                <p class="mb-0" style="color: rgba(255,255,255,0.9); font-size: 15px;">
                    Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ ÙˆØ§Ù†Ø´Ø±Ù‡ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ Ù„ÙŠØµÙ„ Ø¥Ù„Ù‰ Ø¢Ù„Ø§Ù Ø§Ù„Ø£Ø´Ø®Ø§Øµ
                </p>
            </div>
        </div>
    </header>

    <!-- Ù‚Ø³Ù… Ø§Ù„ÙÙ„ØªØ±Ø© -->
    <section class="filter-section">
        <div class="container">
            <h3 class="filter-title">
                <i class="fas fa-filter"></i>
                ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            </h3>
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="fas fa-tags"></i>
                        Ø§Ù„ÙØ¦Ø©
                    </label>
                    <select class="form-select" id="categoryFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="fas fa-store"></i>
                        Ø§Ù„ØªØ§Ø¬Ø±
                    </label>
                    <select class="form-select" id="merchantFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="fas fa-sort-amount-down"></i>
                        Ø§Ù„ØªØ±ØªÙŠØ¨
                    </label>
                    <select class="form-select" id="sortFilter">
                        <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
                        <option value="price_low">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰</option>
                        <option value="price_high">Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„</option>
                        <option value="name">Ø§Ù„Ø§Ø³Ù… Ø£Ø¨Ø¬Ø¯ÙŠÙ‹Ø§</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">
                        <i class="fas fa-search"></i>
                        Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                    </label>
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" 
                               class="form-control" 
                               id="searchInput" 
                               placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬, ÙˆØµÙ, ØªØ§Ø¬Ø±...">
                    </div>
                </div>
            </div>
            <div class="filter-actions mt-3">
                <button class="btn btn-primary" id="applyFilters">
                    <i class="fas fa-check"></i>
                    ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
                </button>
                <button class="btn btn-outline-secondary" id="resetFilters">
                    <i class="fas fa-redo"></i>
                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                </button>
            </div>
        </div>
    </section>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    <section class="products-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-box-open"></i>
                    Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                </h2>
                <div class="products-count" id="productsCount">
                    0 Ù…Ù†ØªØ¬
                </div>
            </div>
            
            <div id="productsContainer">
                <!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <div class="share-modal-header">
                <button class="share-modal-close" id="closeShareModal">
                    <i class="fas fa-times"></i>
                </button>
                <h3 class="share-modal-title">
                    <i class="fab fa-facebook"></i>
                    Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
                </h3>
                <p class="share-modal-subtitle">
                    Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø´Ø§Ø±ÙƒÙ‡ Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨
                </p>
            </div>
            <div class="share-modal-body">
                <div class="share-preview-container">
                    <h4 class="share-preview-title">
                        <i class="fas fa-eye"></i>
                        Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                    </h4>
                    <div class="share-preview">
                        <img id="sharePreviewImage" 
                             class="share-preview-image" 
                             alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
                        <div class="share-preview-content">
                            <p id="sharePreviewText" class="share-preview-text">
                                Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬...
                            </p>
                            <div class="share-url-container">
                                <label class="share-url-label">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:</label>
                                <div id="sharePreviewUrl" class="share-url">
                                    Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="share-actions">
                    <button class="btn btn-copy" id="copyLinkBtn">
                        <i class="far fa-copy"></i>
                        Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
                    </button>
                    <button class="btn btn-share-facebook" id="shareOnFacebookBtn">
                        <i class="fab fa-facebook-f"></i>
                        Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
                    </button>
                    <button class="btn btn-share-whatsapp" id="shareOnWhatsappBtn">
                        <i class="fab fa-whatsapp"></i>
                        Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
                    </button>
                </div>
            </div>
            <div class="share-modal-footer">
                <p>ğŸ“¢ Ø³ØªØ¸Ù‡Ø± ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ ÙˆÙˆØµÙÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø·</p>
                <p>ğŸ“ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: <strong>https://facebook.com/groups/1650698542573379/</strong></p>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ÙÙˆØªØ± -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                     alt="Ø´Ø¹Ø§Ø± AZ" 
                     class="footer-logo">
                <p class="footer-text">
                    Â© 2024 AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©<br>
                    Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„ØªÙ„Ø¨ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ØªØ³ÙˆÙ‚ÙŠØ©
                </p>
                <a href="az_suq.html" class="back-to-home">
                    <i class="fas fa-arrow-right"></i>
                    Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </a>
            </div>
        </div>
    </footer>

    <!-- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
    <div id="notificationContainer"></div>

    <!-- Ù…ÙƒØªØ¨Ø© Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ==========================================
        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
        // ==========================================
        const firebaseConfig = {
            databaseURL: "https://chat-fat-free-default-rtdb.firebaseio.com/"
        };

        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ù†Ø¬Ø§Ø­');
            }
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase:", error);
            showError('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }

        const db = firebase.database();

        // ==========================================
        // ğŸ“¦ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        let allProducts = [];
        let allMerchants = [];
        let allCategories = [];
        let filteredProducts = [];
        let currentProductForShare = null;
        let currentShareUrl = '';
        let currentShareText = '';

        // ==========================================
        // ğŸ¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©...');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            loadAllData();
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            setupEventListeners();
        });

        // ==========================================
        // ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        // ==========================================
        async function loadAllData() {
            try {
                showLoading();
                
                const [productsSnap, merchantsSnap, categoriesSnap] = await Promise.all([
                    db.ref("products").once("value"),
                    db.ref("merchants").once("value"),
                    db.ref("categories").once("value")
                ]);

                allProducts = convertFirebaseData(productsSnap.val()) || [];
                allMerchants = convertFirebaseData(merchantsSnap.val()) || [];
                allCategories = convertFirebaseData(categoriesSnap.val()) || [];

                console.log('ğŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', {
                    products: allProducts.length,
                    merchants: allMerchants.length,
                    categories: allCategories.length
                });

                // ØªØµÙÙŠØ© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ø§Ø± Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
                filterActiveProducts();
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ÙÙ„Ø§ØªØ±
                populateFilters();
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                displayProducts();
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
                updateProductsCount();

            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
            }
        }

        // ==========================================
        // ğŸ”„ ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Firebase
        // ==========================================
        function convertFirebaseData(firebaseData) {
            if (!firebaseData) return [];
            try {
                return Object.entries(firebaseData).map(([id, data]) => {
                    return { id, ...data };
                });
            } catch (e) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", e);
                return [];
            }
        }

        // ==========================================
        // ğŸª ØªØµÙÙŠØ© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªØ¬Ø§Ø± Ø§Ù„Ù†Ø´Ø·ÙŠÙ†
        // ==========================================
        function filterActiveProducts() {
            filteredProducts = allProducts.filter(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (!merchant) return false;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø¬Ø± Ù†Ø´Ø·
                const isActive = merchant.status === "active" || 
                                merchant.status === "Ù†Ø´Ø·" || 
                                merchant.status === "Active";
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø¬Ø±
                const isMerchant = merchant.job === "ØªØ§Ø¬Ø±" || 
                                  merchant.type === "ØªØ§Ø¬Ø±" ||
                                  merchant.job === "ØªØ§Ø¬Ø±Ù‡" ||
                                  merchant.role === "ØªØ§Ø¬Ø±";
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙˆØ± Ù„Ù„Ù…Ù†ØªØ¬
                const hasImages = extractProductImages(product).length > 0;
                
                return isActive && isMerchant && hasImages && product.name && product.name.trim() !== '';
            });
            
            console.log('âœ… ØªÙ… ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', {
                total: allProducts.length,
                active: filteredProducts.length
            });
        }

        // ==========================================
        // ğŸ–¼ï¸ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬
        // ==========================================
        function extractProductImages(product) {
            const images = [];
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ„ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
            const imageFields = ['image', 'imageUrl', 'imageUrls', 'images', 'photo', 'photos', 'ØµÙˆØ±', 'ØµÙˆØ±Ø©'];
            
            imageFields.forEach(field => {
                if (product[field]) {
                    if (Array.isArray(product[field])) {
                        product[field].forEach(img => {
                            if (img && img.trim() !== '') {
                                images.push(img.trim());
                            }
                        });
                    } else if (typeof product[field] === 'string') {
                        // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„ Ø£Ùˆ Ø£Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯Ø©
                        const splitImages = product[field].split(/[,\n]/)
                            .map(img => img.trim())
                            .filter(img => img !== '');
                        
                        images.push(...splitImages);
                    }
                }
            });
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØµÙˆØ±ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            if (images.length === 0) {
                images.push('https://drive.google.com/thumbnail?id=1-qn1bTCIhgF1E5wm5RVRdm1pYLeNZCNC&sz=w800');
            }
            
            return images;
        }

        // ==========================================
        // ğŸ”— ØªÙ†Ø³ÙŠÙ‚ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©
        // ==========================================
        function formatImageUrl(url) {
            if (!url || typeof url !== 'string') {
                return 'https://drive.google.com/thumbnail?id=1-qn1bTCIhgF1E5wm5RVRdm1pYLeNZCNC&sz=w800';
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Google Drive
            if (url.includes('drive.google.com')) {
                let fileId = '';
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù„Ù Ù…Ù† Ù…Ø®ØªÙ„Ù ØµÙŠØº Google Drive
                if (url.includes('/d/')) {
                    fileId = url.split('/d/')[1].split('/')[0];
                } else if (url.includes('id=')) {
                    fileId = url.split('id=')[1].split('&')[0];
                } else if (url.includes('/file/d/')) {
                    fileId = url.split('/file/d/')[1].split('/')[0];
                } else if (url.includes('uc?id=')) {
                    fileId = url.split('uc?id=')[1].split('&')[0];
                }
                
                if (fileId) {
                    return `https://drive.google.com/thumbnail?id=${fileId}&sz=w1200`;
                }
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø§Ù‹
            if (url.startsWith('http')) {
                return url;
            }
            
            // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            return 'https://drive.google.com/thumbnail?id=1-qn1bTCIhgF1E5wm5RVRdm1pYLeNZCNC&sz=w800';
        }

        // ==========================================
        // ğŸ“‹ ØªØ¹Ø¨Ø¦Ø© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function populateFilters() {
            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ÙØ¦Ø§Øª
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>';
            
            const categoriesMap = new Map();
            allCategories.forEach(category => {
                if (category.name && category.id) {
                    categoriesMap.set(category.id, category.name);
                }
            });
            
            categoriesMap.forEach((name, id) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = name;
                categoryFilter.appendChild(option);
            });

            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ØªØ¬Ø§Ø±
            const merchantFilter = document.getElementById('merchantFilter');
            merchantFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>';
            
            const merchantsMap = new Map();
            filteredProducts.forEach(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (merchant && merchant.name) {
                    merchantsMap.set(merchant.id, merchant.name);
                }
            });
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ¬Ø§Ø± Ø£Ø¨Ø¬Ø¯ÙŠØ§Ù‹
            const sortedMerchants = Array.from(merchantsMap.entries())
                .sort((a, b) => a[1].localeCompare(b[1]));
            
            sortedMerchants.forEach(([id, name]) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = name;
                merchantFilter.appendChild(option);
            });
        }

        // ==========================================
        // ğŸ¯ Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        // ==========================================
        function setupEventListeners() {
            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ÙÙ„Ø§ØªØ±
            document.getElementById('applyFilters').addEventListener('click', applyFilters);
            document.getElementById('resetFilters').addEventListener('click', resetFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('categoryFilter').addEventListener('change', applyFilters);
            document.getElementById('merchantFilter').addEventListener('change', applyFilters);
            document.getElementById('sortFilter').addEventListener('change', applyFilters);

            // Ø£Ø­Ø¯Ø§Ø« Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            document.getElementById('closeShareModal').addEventListener('click', closeShareModal);
            document.getElementById('copyLinkBtn').addEventListener('click', copyShareLink);
            document.getElementById('shareOnFacebookBtn').addEventListener('click', shareOnFacebook);
            document.getElementById('shareOnWhatsappBtn').addEventListener('click', shareOnWhatsapp);

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.getElementById('shareModal').addEventListener('click', (e) => {
                if (e.target.id === 'shareModal') {
                    closeShareModal();
                }
            });

            // Ø§Ø®ØªØµØ§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeShareModal();
                }
            });
        }

        // ==========================================
        // ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryId = document.getElementById('categoryFilter').value;
            const merchantId = document.getElementById('merchantFilter').value;
            const sortBy = document.getElementById('sortFilter').value;

            let filtered = [...filteredProducts];

            // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø«
            if (searchTerm) {
                filtered = filtered.filter(product => {
                    const productName = (product.name || '').toLowerCase();
                    const productDesc = (product.description || '').toLowerCase();
                    const merchant = allMerchants.find(m => m.id === product.userId);
                    const merchantName = (merchant?.name || '').toLowerCase();
                    
                    return productName.includes(searchTerm) || 
                           productDesc.includes(searchTerm) || 
                           merchantName.includes(searchTerm);
                });
            }

            // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
            if (categoryId) {
                filtered = filtered.filter(product => product.categoryId === categoryId);
            }

            // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø¬Ø±
            if (merchantId) {
                filtered = filtered.filter(product => product.userId === merchantId);
            }

            // Ø§Ù„ØªØ±ØªÙŠØ¨
            filtered.sort((a, b) => {
                switch(sortBy) {
                    case 'price_low':
                        return (parseFloat(a.price) || 0) - (parseFloat(b.price) || 0);
                    case 'price_high':
                        return (parseFloat(b.price) || 0) - (parseFloat(a.price) || 0);
                    case 'name':
                        return (a.name || '').localeCompare(b.name || '');
                    case 'newest':
                    default:
                        const dateA = new Date(a.publishDate || a.createdAt || a.date || 0);
                        const dateB = new Date(b.publishDate || b.createdAt || b.date || 0);
                        return dateB - dateA;
                }
            });

            displayProducts(filtered);
            updateProductsCount(filtered.length);
        }

        // ==========================================
        // ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('merchantFilter').value = '';
            document.getElementById('sortFilter').value = 'newest';
            
            applyFilters();
            showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±', 'success');
        }

        // ==========================================
        // ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        // ==========================================
        function displayProducts(products = filteredProducts) {
            const container = document.getElementById('productsContainer');
            
            if (!products || products.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open empty-icon"></i>
                        <h3 class="empty-title">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</h3>
                        <p class="empty-message">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                        <button class="btn btn-primary" onclick="resetFilters()">
                            <i class="fas fa-redo"></i>
                            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                        </button>
                    </div>
                `;
                return;
            }

            const productsHTML = products.map(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                const category = allCategories.find(c => c.id === product.categoryId);
                const images = extractProductImages(product);
                const mainImage = formatImageUrl(images[0]);
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¨Ø§Ø¯Ø¬Ø§Øª
                const badges = [];
                if (product.productType === 'Ø¹Ø±Ø¶') {
                    badges.push('<span class="product-badge badge-offer"><i class="fas fa-tag"></i> Ø¹Ø±Ø¶ Ø®Ø§Øµ</span>');
                }
                if (isNewProduct(product)) {
                    badges.push('<span class="product-badge badge-new"><i class="fas fa-star"></i> Ø¬Ø¯ÙŠØ¯</span>');
                }
                
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø³Ø¹Ø±
                const price = product.price ? 
                    `${parseFloat(product.price).toLocaleString('ar-EG')} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                    'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                
                // ÙˆØµÙ Ù…Ø®ØªØµØ±
                const shortDescription = product.description ? 
                    (product.description.length > 120 ? 
                        product.description.substring(0, 120) + '...' : 
                        product.description) : 
                    'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ù†ØªØ¬';
                
                return `
                    <div class="product-card" data-product-id="${product.id}">
                        <div class="product-image-container">
                            <img src="${mainImage}" 
                                 alt="${product.name || 'Ù…Ù†ØªØ¬'}" 
                                 class="product-image"
                                 loading="lazy">
                            <div class="product-badges">
                                ${badges.join('')}
                            </div>
                        </div>
                        <div class="product-content">
                            <h3 class="product-title">${product.name || 'Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</h3>
                            
                            <div class="product-meta">
                                <div class="product-price">
                                    <i class="fas fa-money-bill-wave"></i>
                                    ${price}
                                </div>
                                <div class="product-category">
                                    <i class="fas fa-tag"></i>
                                    ${category?.name || 'ØºÙŠØ± Ù…ØµÙ†Ù'}
                                </div>
                            </div>
                            
                            <p class="product-description">${shortDescription}</p>
                            
                            ${merchant ? `
                                <div class="merchant-info">
                                    <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                                         alt="${merchant.name}" 
                                         class="merchant-avatar">
                                    <div class="merchant-details">
                                        <div class="merchant-name">
                                            <i class="fas fa-store"></i>
                                            ${merchant.name || merchant.username || 'ØªØ§Ø¬Ø±'}
                                        </div>
                                        <div class="merchant-location">
                                            <i class="fas fa-map-marker-alt"></i>
                                            ${merchant.governorate || merchant.city || 'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                            
                            <div class="share-buttons">
                                <button class="btn-facebook-share" onclick="openShareModal('${product.id}')">
                                    <i class="fab fa-facebook-f"></i>
                                    Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
                                </button>
                                <button class="btn-whatsapp-share" onclick="shareProductOnWhatsApp('${product.id}')">
                                    <i class="fab fa-whatsapp"></i>
                                    Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="products-grid">
                    ${productsHTML}
                </div>
            `;
        }

        // ==========================================
        // ğŸ“Š ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        // ==========================================
        function updateProductsCount(count = filteredProducts.length) {
            const countElement = document.getElementById('productsCount');
            countElement.textContent = `${count} Ù…Ù†ØªØ¬${count === 1 ? '' : 'Ø§Øª'}`;
        }

        // ==========================================
        // ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
        // ==========================================
        function isNewProduct(product) {
            const productDate = new Date(product.publishDate || product.createdAt || product.date || 0);
            const now = new Date();
            const diffDays = Math.floor((now - productDate) / (1000 * 60 * 60 * 24));
            return diffDays <= 7; // Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù…Ø±Ù‡ Ø£Ù‚Ù„ Ù…Ù† 7 Ø£ÙŠØ§Ù…
        }

        // ==========================================
        // ğŸ“¤ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function openShareModal(productId) {
            const product = filteredProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            currentProductForShare = product;
            
            // ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            prepareShareData(product);
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
            document.getElementById('shareModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // ==========================================
        // ğŸ“ ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function prepareShareData(product) {
            const merchant = allMerchants.find(m => m.id === product.userId);
            const category = allCategories.find(c => c.id === product.categoryId);
            const images = extractProductImages(product);
            const mainImage = formatImageUrl(images[0]);
            
            // ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            document.getElementById('sharePreviewImage').src = mainImage;
            document.getElementById('sharePreviewImage').alt = product.name || 'Ù…Ù†ØªØ¬';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Øµ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹';
            const productPrice = product.price ? 
                `${parseFloat(product.price).toLocaleString('ar-EG')} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²';
            
            const shareText = `ğŸ›ï¸ ${productName} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${productPrice}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø± Ù…ÙˆØ«ÙˆÙ‚'}
ğŸ“‚ Ø§Ù„ÙØ¦Ø©: ${category?.name || 'Ù…ØªÙ†ÙˆØ¹'}

${product.description ? `ğŸ“ ${product.description}` : 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„'}

ğŸŒŸ Ù…Ù…ÙŠØ²Ø§Øª:
â€¢ Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© âœ“
â€¢ Ø³Ø¹Ø± Ù…Ù†Ø§Ø³Ø¨ âœ“
â€¢ ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ âœ“
â€¢ Ø¶Ù…Ø§Ù† Ø§Ù„Ø¬ÙˆØ¯Ø© âœ“

ğŸ›’ Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† Ø¹Ø¨Ø± AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„
ğŸ“ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬:`;

            // Ø­ÙØ¸ Ù†Øµ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹
            currentShareText = shareText;
            
            // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            document.getElementById('sharePreviewText').textContent = shareText;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            const shareUrl = createShareUrl(product);
            currentShareUrl = shareUrl;
            
            // ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            document.getElementById('sharePreviewUrl').textContent = shareUrl;
        }

        // ==========================================
        // ğŸ”— Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function createShareUrl(product) {
            const baseUrl = window.location.origin + window.location.pathname;
            const productId = product.id;
            const productName = encodeURIComponent(product.name || 'Ù…Ù†ØªØ¬');
            
            // Ø¥Ø¶Ø§ÙØ© Open Graph Parameters
            const images = extractProductImages(product);
            const mainImage = formatImageUrl(images[0]);
            const description = product.description ? 
                encodeURIComponent(product.description.substring(0, 200)) : 
                encodeURIComponent('Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„');
            
            return `${baseUrl}?productId=${productId}&productName=${productName}&image=${encodeURIComponent(mainImage)}&description=${description}`;
        }

        // ==========================================
        // ğŸ“¥ Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function closeShareModal() {
            document.getElementById('shareModal').classList.remove('active');
            document.body.style.overflow = '';
            currentProductForShare = null;
            currentShareUrl = '';
            currentShareText = '';
        }

        // ==========================================
        // ğŸ“‹ Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function copyShareLink() {
            if (!currentShareUrl) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· Ù„Ù„Ù†Ø³Ø®', 'error');
                return;
            }

            navigator.clipboard.writeText(currentShareUrl)
                .then(() => {
                    const btn = document.getElementById('copyLinkBtn');
                    const originalHTML = btn.innerHTML;
                    
                    btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                    btn.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
                    
                    setTimeout(() => {
                        btn.innerHTML = originalHTML;
                        btn.style.background = '';
                    }, 2000);
                    
                    showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
                })
                .catch(err => {
                    console.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø³Ø®:', err);
                    showNotification('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'error');
                });
        }

        // ==========================================
        // ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Facebook
        // ==========================================
        function shareOnFacebook() {
            if (!currentShareUrl || !currentProductForShare) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }

            const product = currentProductForShare;
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            
            // Ø±Ø§Ø¨Ø· Ù…Ø¬Ù…ÙˆØ¹Ø© Facebook Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©
            const facebookGroupUrl = 'https://facebook.com/groups/1650698542573379/';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ© Facebook Ù…Ø¹ Ù…Ø¹Ù„Ù…Ø§Øª Open Graph
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentShareUrl)}&quote=${encodeURIComponent(productName)}&hashtag=%23AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„`;
            
            // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©
            window.open(shareUrl, '_blank', 'width=700,height=600,scrollbars=yes');
            
            // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            closeShareModal();
            
            // ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            trackShare('facebook');
            
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ Facebook Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'info');
        }

        // ==========================================
        // ğŸ“± Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ WhatsApp
        // ==========================================
        function shareOnWhatsapp() {
            if (!currentShareUrl || !currentShareText) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }

            const message = `${currentShareText}\n\n${currentShareUrl}\n\n#AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„`;
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            
            // ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            trackShare('whatsapp');
            
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ WhatsApp Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'info');
        }

        // ==========================================
        // ğŸš€ Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ WhatsApp (Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©)
        // ==========================================
        function shareProductOnWhatsApp(productId) {
            const product = filteredProducts.find(p => p.id === productId);
            if (!product) return;

            const merchant = allMerchants.find(m => m.id === product.userId);
            const category = allCategories.find(c => c.id === product.categoryId);
            
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹';
            const productPrice = product.price ? 
                `${parseFloat(product.price).toLocaleString('ar-EG')} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²';
            
            const message = `ğŸ›ï¸ ${productName} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${productPrice}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø±'}
ğŸ“‚ Ø§Ù„ÙØ¦Ø©: ${category?.name || 'Ù…ØªÙ†ÙˆØ¹'}

${product.description ? `ğŸ“ ${product.description.substring(0, 150)}${product.description.length > 150 ? '...' : ''}` : 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©'}

ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø·: ${window.location.origin}/facebook_share.html?productId=${productId}

ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù† Ø¹Ø¨Ø± AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©
#AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„ #ØªØ³ÙˆÙ‚ #Ù…Ù†ØªØ¬Ø§Øª`;

            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            trackShare('whatsapp');
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ WhatsApp Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'success');
        }

        // ==========================================
        // ğŸ“Š ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ§Øª
        // ==========================================
        function trackShare(platform) {
            if (!currentProductForShare) return;
            
            const productId = currentProductForShare.id;
            const timestamp = new Date().toISOString();
            
            // Ø­ÙØ¸ Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Firebase
            const shareData = {
                productId: productId,
                platform: platform,
                timestamp: timestamp,
                productName: currentProductForShare.name,
                url: currentShareUrl
            };
            
            const shareRef = db.ref(`shares/${productId}/${Date.now()}`);
            shareRef.set(shareData)
                .then(() => {
                    console.log(`âœ… ØªÙ… ØªØªØ¨Ø¹ Ù…Ø´Ø§Ø±ÙƒØ© ${platform} Ù„Ù„Ù…Ù†ØªØ¬ ${productId}`);
                })
                .catch(error => {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:', error);
                });
            
            // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ§Øª ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
            const shareCount = parseInt(localStorage.getItem('totalShares') || '0') + 1;
            localStorage.setItem('totalShares', shareCount.toString());
        }

        // ==========================================
        // ğŸ’¾ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        // ==========================================
        function updateLocalStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.warn('ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:', e);
            }
        }

        function getFromLocalStorage(key) {
            try {
                const data = localStorage.getItem(key);
                return data ? JSON.parse(data) : null;
            } catch (e) {
                console.warn('ØªØ¹Ø°Ø± Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ:', e);
                return null;
            }
        }

        // ==========================================
        // ğŸ”” ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ø±Ø¶
        // ==========================================
        function showLoading() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
                </div>
            `;
        }

        function showError(message) {
            const container = document.getElementById('productsContainer');
            container.innerHTML = `
                <div class="error-state">
                    <i class="fas fa-exclamation-triangle error-icon"></i>
                    <h3 class="error-title">Ø­Ø¯Ø« Ø®Ø·Ø£</h3>
                    <p class="error-message">${message}</p>
                    <button class="btn btn-primary" onclick="location.reload()">
                        <i class="fas fa-redo"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
                    </button>
                </div>
            `;
        }

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notificationId = 'notification-' + Date.now();
            
            const notification = document.createElement('div');
            notification.id = notificationId;
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                const element = document.getElementById(notificationId);
                if (element) {
                    element.remove();
                }
            }, 3000);
        }

        // ==========================================
        // ğŸ” Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø¹Ù„Ù…Ø§Øª URL
        // ==========================================
        function handleUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (productId) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø¹Ø±Ù Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¨Ø§Ø´Ø±Ø©
                setTimeout(() => {
                    openShareModal(productId);
                }, 1000);
            }
        }

        // ==========================================
        // ğŸ¯ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        // ==========================================
        window.addEventListener('load', () => {
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø¹Ù„Ù…Ø§Øª URL
            handleUrlParameters();
            
            // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± ØªØ±Ø­ÙŠØ¨ÙŠ
            setTimeout(() => {
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØµÙØ­Ø© Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù†ØªØ¬Ø§Øª AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„', 'info');
            }, 1000);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
            updateProductsCount();
        });

        // ==========================================
        // ğŸŒ Ø¯Ø¹Ù… PWA (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        // ==========================================
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(
                    registration => {
                        console.log('âœ… ServiceWorker registration successful');
                    },
                    err => {
                        console.log('âŒ ServiceWorker registration failed: ', err);
                    }
                );
            });
        }

        // ==========================================
        // ğŸ“± ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„
        // ==========================================
        window.addEventListener('resize', () => {
            // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            if (filteredProducts.length > 0) {
                displayProducts();
            }
        });

        // ==========================================
        // ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
        // ==========================================
        function trackPageView() {
            const pageData = {
                page: 'facebook_share',
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                screenSize: `${window.innerWidth}x${window.innerHeight}`,
                referrer: document.referrer || 'direct'
            };
            
            const viewRef = db.ref('page_views/' + Date.now());
            viewRef.set(pageData)
                .then(() => {
                    console.log('ğŸ“Š ØªÙ… ØªØªØ¨Ø¹ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©');
                })
                .catch(error => {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØªØ¨Ø¹ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©:', error);
                });
        }

        // ØªØªØ¨Ø¹ Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©
        trackPageView();

        // ==========================================
        // ğŸ¯ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù…
        // ==========================================
        window.shareOnFacebook = shareOnFacebook;
        window.shareOnWhatsapp = shareOnWhatsapp;
        window.shareProductOnWhatsApp = shareProductOnWhatsApp;
        window.openShareModal = openShareModal;
        window.closeShareModal = closeShareModal;
        window.copyShareLink = copyShareLink;
        window.resetFilters = resetFilters;

        console.log('ğŸ‰ ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­');
    </script>
</body>
    </html>
