Ù¡
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</title>
    
    <!-- Open Graph Tags Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© - Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">
    <meta property="og:site_name" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    
    <!-- Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    <meta property="og:title" id="og-title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù†ØªØ¬Ø§Øª ÙˆØ¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ©">
    <meta property="og:description" id="og-description" content="Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta property="og:image" id="og-image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    <meta property="og:url" id="og-url" content="https://e772299420-hue.github.io/Call/facebook_share.html">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/jpeg">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitter-title" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ù†ØªØ¬Ø§Øª ÙˆØ¹Ø±ÙˆØ¶ Ø­ØµØ±ÙŠØ©">
    <meta name="twitter:description" id="twitter-description" content="Ø§ÙƒØªØ´Ù Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    <meta name="twitter:image" id="twitter-image" content="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png">
    
    <!-- ÙˆØµÙ Ø§Ù„ØµÙØ­Ø© -->
    <meta name="description" content="Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨">
    <meta name="keywords" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„, ÙÙŠØ³Ø¨ÙˆÙƒ, Ù…Ø´Ø§Ø±ÙƒØ©, Ù…Ù†ØªØ¬Ø§Øª, Ø¹Ø±ÙˆØ¶, ØªØ³ÙˆÙ‚">
    <meta name="author" content="AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„">
    
    <!-- Ø±Ø¨Ø· Ù…ÙƒØªØ¨Ø§Øª Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #1877F2;
            --secondary-color: #4267B2;
            --success-color: #42b72a;
            --dark-color: #1c1e21;
            --light-color: #f0f2f5;
            --border-radius: 12px;
            --box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .main-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
        }

        .brand-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .brand-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 20px;
            background: white;
            padding: 10px;
            border: 3px solid white;
        }

        .brand-text h1 {
            font-size: 28px;
            font-weight: 800;
            margin: 0 0 10px 0;
        }

        .brand-text p {
            opacity: 0.9;
            font-size: 16px;
            margin: 0;
        }

        /* Ù…Ù†ØªØ¬ Ù…ÙØ±Ø¯ (Ø¹Ù†Ø¯ ÙØªØ­ Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ©) */
        .single-product-view {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .product-image-container {
            width: 100%;
            height: 400px;
            overflow: hidden;
            position: relative;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #f8f9fa;
        }

        .product-details {
            padding: 30px;
        }

        .product-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--dark-color);
            margin: 0 0 20px 0;
            line-height: 1.3;
        }

        .product-price {
            font-size: 36px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .product-description {
            font-size: 18px;
            line-height: 1.8;
            color: #495057;
            margin-bottom: 30px;
            white-space: pre-line;
        }

        .merchant-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .merchant-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }

        .merchant-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .share-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .share-buttons {
                grid-template-columns: 1fr;
            }
        }

        .share-btn {
            padding: 18px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .btn-facebook {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .products-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
            margin: 0;
        }

        .products-count {
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
        .product-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 2px solid transparent;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .card-image-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
        }

        .card-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #f8f9fa;
            transition: transform 0.5s ease;
        }

        .product-card:hover .card-image {
            transform: scale(1.05);
        }

        .card-content {
            padding: 20px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin: 0 0 10px 0;
            line-height: 1.4;
        }

        .card-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .card-description {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-share-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .card-share-btn:hover {
            background: linear-gradient(135deg, #166fe5, #29487d);
            transform: translateY(-2px);
        }

        /* Ø§Ù„ÙÙ„ØªØ±Ø© */
        .filter-section {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }

        .filter-input, .filter-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5eb;
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .filter-actions {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-apply {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-reset {
            background: #e9ecef;
            color: #495057;
        }

        /* Ø§Ù„ÙÙˆØªØ± */
        .main-footer {
            background: var(--dark-color);
            color: white;
            padding: 40px 20px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            text-align: center;
        }

        .footer-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 20px;
        }

        .back-home {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 30px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-home:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
        }

        /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 10000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            max-width: 400px;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
            }
        }

        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f0f2f5;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© */
        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .share-modal.active {
            display: flex;
        }

        .share-modal-content {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .share-modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
        }

        .share-modal-body {
            padding: 25px;
        }

        .share-preview {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .share-preview-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 15px;
            background: white;
            border: 2px solid var(--primary-color);
        }

        .share-text-preview {
            white-space: pre-line;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .share-url-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5eb;
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
        }

        .share-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        @media (max-width: 576px) {
            .share-actions {
                grid-template-columns: 1fr;
            }
        }

        .share-action-btn {
            padding: 15px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-copy {
            background: #6c757d;
            color: white;
        }

        .btn-facebook-action {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-whatsapp-action {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="main-header" id="mainHeader">
            <div class="brand-section">
                <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                     alt="Ø´Ø¹Ø§Ø± AZ" 
                     class="brand-logo">
                <div class="brand-text">
                    <h1>AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                    <p>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨</p>
                </div>
            </div>
        </header>

        <!-- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯ (Ø¹Ù†Ø¯ ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©) -->
        <div id="singleProductView" style="display: none;">
            <div class="single-product-view">
                <div class="product-image-container">
                    <img id="singleProductImage" class="product-image" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
                </div>
                <div class="product-details">
                    <h1 id="singleProductTitle" class="product-title"></h1>
                    <div id="singleProductPrice" class="product-price"></div>
                    <div id="singleProductDescription" class="product-description"></div>
                    
                    <div class="merchant-info" id="singleProductMerchant">
                        <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                             alt="Ø§Ù„ØªØ§Ø¬Ø±" 
                             class="merchant-avatar">
                        <div>
                            <div class="merchant-name" id="merchantName"></div>
                            <div id="merchantLocation"></div>
                        </div>
                    </div>

                    <div class="share-buttons">
                        <button class="share-btn btn-facebook" onclick="shareCurrentProduct('facebook')">
                            <i class="fab fa-facebook-f"></i>
                            Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ
                        </button>
                        <button class="share-btn btn-whatsapp" onclick="shareCurrentProduct('whatsapp')">
                            <i class="fab fa-whatsapp"></i>
                            Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div id="allProductsView">
            <!-- Ù‚Ø³Ù… Ø§Ù„ÙÙ„ØªØ±Ø© -->
            <section class="filter-section">
                <div class="filter-grid">
                    <div class="filter-group">
                        <label>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬</label>
                        <input type="text" id="searchInput" class="filter-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬...">
                    </div>
                    <div class="filter-group">
                        <label>Ø§Ù„ÙØ¦Ø©</label>
                        <select id="categoryFilter" class="filter-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Ø§Ù„ØªØ§Ø¬Ø±</label>
                        <select id="merchantFilter" class="filter-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>
                        </select>
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="filter-btn btn-apply" onclick="applyFilters()">
                        <i class="fas fa-filter"></i>
                        ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
                    </button>
                    <button class="filter-btn btn-reset" onclick="resetFilters()">
                        <i class="fas fa-redo"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                </div>
            </section>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
            <div class="products-header">
                <h2 class="products-title">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©</h2>
                <div class="products-count" id="productsCount">0 Ù…Ù†ØªØ¬</div>
            </div>

            <div id="productsContainer">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <div class="share-modal-header">
                <h2 style="margin: 0; color: white;">
                    <i class="fab fa-facebook"></i>
                    Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬
                </h2>
            </div>
            <div class="share-modal-body">
                <div class="share-preview">
                    <img id="sharePreviewImage" class="share-preview-image" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
                    <div id="sharePreviewText" class="share-text-preview"></div>
                    <input type="text" id="sharePreviewUrl" class="share-url-input" readonly>
                </div>
                <div class="share-actions">
                    <button class="share-action-btn btn-copy" onclick="copyShareLink()">
                        <i class="far fa-copy"></i>
                        Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·
                    </button>
                    <button class="share-action-btn btn-facebook-action" onclick="openFacebookShare()">
                        <i class="fab fa-facebook-f"></i>
                        ÙØªØ­ ÙÙŠØ³Ø¨ÙˆÙƒ
                    </button>
                    <button class="share-action-btn btn-whatsapp-action" onclick="openWhatsAppShare()">
                        <i class="fab fa-whatsapp"></i>
                        ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ÙÙˆØªØ± -->
    <footer class="main-footer">
        <div class="container">
            <img src="https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png" 
                 alt="Ø´Ø¹Ø§Ø± AZ" 
                 class="footer-logo">
            <p>Â© 2024 AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
            <p>Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„ØªÙ„Ø¨ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ Ø§Ù„ØªØ³ÙˆÙ‚ÙŠØ©</p>
            <a href="az_suq.html" class="back-home">
                <i class="fas fa-arrow-left"></i>
                Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
        </div>
    </footer>

    <script>
        // ==========================================
        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
        // ==========================================
        const firebaseConfig = {
            databaseURL: "https://chat-fat-free-default-rtdb.firebaseio.com/"
        };

        try {
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Firebase Ø¨Ù†Ø¬Ø§Ø­');
            }
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase:", error);
        }

        const db = firebase.database();

        // ==========================================
        // ğŸ“¦ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        let allProducts = [];
        let allMerchants = [];
        let allCategories = [];
        let currentProductForShare = null;
        let currentShareUrl = '';
        let isSingleProductView = false;

        // ==========================================
        // ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø¹Ø±Ù Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (productId) {
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
                loadAndDisplaySingleProduct(productId);
            } else {
                // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                loadAllData();
            }
            
            // ØªØ­Ø¯ÙŠØ« Open Graph Tags
            updateOpenGraphTags();
        });

        // ==========================================
        // ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        // ==========================================
        async function loadAllData() {
            try {
                const [productsSnap, merchantsSnap, categoriesSnap] = await Promise.all([
                    db.ref("products").once("value"),
                    db.ref("merchants").once("value"),
                    db.ref("categories").once("value")
                ]);

                allProducts = convertFirebaseData(productsSnap.val()) || [];
                allMerchants = convertFirebaseData(merchantsSnap.val()) || [];
                allCategories = convertFirebaseData(categoriesSnap.val()) || [];

                console.log('ğŸ“Š ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', {
                    products: allProducts.length,
                    merchants: allMerchants.length,
                    categories: allCategories.length
                });

                // ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
                const activeProducts = filterActiveProducts(allProducts);
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ÙÙ„Ø§ØªØ±
                populateFilters(activeProducts);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                displayProducts(activeProducts);

            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }

        // ==========================================
        // ğŸ”„ ØªØ­ÙˆÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Firebase
        // ==========================================
        function convertFirebaseData(firebaseData) {
            if (!firebaseData) return [];
            try {
                return Object.entries(firebaseData).map(([id, data]) => {
                    return { id, ...data };
                });
            } catch (e) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", e);
                return [];
            }
        }

        // ==========================================
        // ğŸª ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
        // ==========================================
        function filterActiveProducts(products) {
            return products.filter(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (!merchant) return false;
                
                const isActive = merchant.status === "active" || 
                                merchant.status === "Ù†Ø´Ø·" || 
                                merchant.status === "Active";
                
                const isMerchant = merchant.job === "ØªØ§Ø¬Ø±" || 
                                  merchant.type === "ØªØ§Ø¬Ø±" ||
                                  merchant.job === "ØªØ§Ø¬Ø±Ù‡";
                
                return isActive && isMerchant;
            });
        }

        // ==========================================
        // ğŸ–¼ï¸ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬
        // ==========================================
        function extractProductImage(product) {
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ„ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
            const imageFields = ['image', 'imageUrl', 'imageUrls', 'images', 'photo', 'photos', 'ØµÙˆØ±Ø©', 'ØµÙˆØ±'];
            
            for (const field of imageFields) {
                if (product[field]) {
                    if (Array.isArray(product[field])) {
                        const validImages = product[field].filter(img => img && img.trim() !== '');
                        if (validImages.length > 0) {
                            return validImages[0];
                        }
                    } else if (typeof product[field] === 'string') {
                        const images = product[field].split(/[,\n]/)
                            .map(img => img.trim())
                            .filter(img => img !== '');
                        
                        if (images.length > 0) {
                            return images[0];
                        }
                    }
                }
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ØµÙˆØ±ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            return 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
        }

        // ==========================================
        // ğŸ”— ØªØ­ÙˆÙŠÙ„ Ø±Ø§Ø¨Ø· Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙ Ø¥Ù„Ù‰ ØµÙŠØºØ© ØµØ§Ù„Ø­Ø©
        // ==========================================
        function formatGoogleDriveUrl(url) {
            if (!url) return 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø§Ø¨Ø·
            url = url.trim();
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙ
            if (url.includes('drive.google.com')) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù„Ù
                let fileId = '';
                
                // Ù†Ù…Ø· 1: https://drive.google.com/file/d/FILE_ID/view
                if (url.includes('/d/')) {
                    const parts = url.split('/d/');
                    if (parts[1]) {
                        fileId = parts[1].split('/')[0];
                    }
                }
                // Ù†Ù…Ø· 2: https://drive.google.com/open?id=FILE_ID
                else if (url.includes('id=')) {
                    const params = new URLSearchParams(url.split('?')[1]);
                    fileId = params.get('id');
                }
                // Ù†Ù…Ø· 3: FILE_ID Ù…Ø¨Ø§Ø´Ø±Ø©
                else if (url.length === 33 && !url.includes('/') && !url.includes('?')) {
                    fileId = url;
                }
                
                if (fileId) {
                    // Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ù‡Ø°Ø§ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ Ù„ÙÙŠØ³Ø¨ÙˆÙƒ
                    return `https://drive.google.com/uc?export=view&id=${fileId}`;
                }
            }
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ù„ÙŠØ³ Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø¯Ø±Ø§ÙŠÙØŒ Ø¥Ø±Ø¬Ø§Ø¹Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ
            return url;
        }

        // ==========================================
        // ğŸ“‹ ØªØ¹Ø¨Ø¦Ø© Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function populateFilters(products) {
            // Ø§Ù„ÙØ¦Ø§Øª
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>';
            
            const categoriesMap = new Map();
            products.forEach(product => {
                if (product.categoryId) {
                    const category = allCategories.find(c => c.id === product.categoryId);
                    if (category && category.name) {
                        categoriesMap.set(category.id, category.name);
                    }
                }
            });
            
            categoriesMap.forEach((name, id) => {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = name;
                categoryFilter.appendChild(option);
            });

            // Ø§Ù„ØªØ¬Ø§Ø±
            const merchantFilter = document.getElementById('merchantFilter');
            merchantFilter.innerHTML = '<option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¬Ø§Ø±</option>';
            
            const merchantsMap = new Map();
            products.forEach(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                if (merchant && merchant.name) {
                    merchantsMap.set(merchant.id, merchant.name);
                }
            });
            
            Array.from(merchantsMap.entries())
                .sort((a, b) => a[1].localeCompare(b[1]))
                .forEach(([id, name]) => {
                    const option = document.createElement('option');
                    option.value = id;
                    option.textContent = name;
                    merchantFilter.appendChild(option);
                });
        }

        // ==========================================
        // ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        // ==========================================
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            const countElement = document.getElementById('productsCount');
            
            if (!products || products.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open fa-4x" style="color: #dee2e6; margin-bottom: 20px;"></i>
                        <h3 style="color: #6c757d;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</h3>
                        <p style="color: #adb5bd;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                    </div>
                `;
                countElement.textContent = '0 Ù…Ù†ØªØ¬';
                return;
            }

            const productsHTML = products.map(product => {
                const merchant = allMerchants.find(m => m.id === product.userId);
                const category = allCategories.find(c => c.id === product.categoryId);
                const imageUrl = formatGoogleDriveUrl(extractProductImage(product));
                const price = product.price ? 
                    `${parseFloat(product.price).toLocaleString('ar-EG')} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                    'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                
                const shortDescription = product.description ? 
                    (product.description.length > 100 ? 
                        product.description.substring(0, 100) + '...' : 
                        product.description) : 
                    'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ù†ØªØ¬';
                
                return `
                    <div class="product-card">
                        <div class="card-image-container">
                            <img src="${imageUrl}" 
                                 alt="${product.name || 'Ù…Ù†ØªØ¬'}" 
                                 class="card-image"
                                 loading="lazy"
                                 onerror="this.src='https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png'">
                        </div>
                        <div class="card-content">
                            <h3 class="card-title">${product.name || 'Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</h3>
                            <div class="card-price">${price}</div>
                            <p class="card-description">${shortDescription}</p>
                            <button class="card-share-btn" onclick="openShareModal('${product.id}')">
                                <i class="fas fa-share-alt"></i>
                                Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="products-grid">
                    ${productsHTML}
                </div>
            `;
            
            countElement.textContent = `${products.length} Ù…Ù†ØªØ¬`;
        }

        // ==========================================
        // ğŸ” ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryId = document.getElementById('categoryFilter').value;
            const merchantId = document.getElementById('merchantFilter').value;

            const activeProducts = filterActiveProducts(allProducts);
            
            let filtered = activeProducts.filter(product => {
                // Ø§Ù„Ø¨Ø­Ø«
                if (searchTerm) {
                    const productName = (product.name || '').toLowerCase();
                    const productDesc = (product.description || '').toLowerCase();
                    const merchant = allMerchants.find(m => m.id === product.userId);
                    const merchantName = (merchant?.name || '').toLowerCase();
                    
                    if (!productName.includes(searchTerm) && 
                        !productDesc.includes(searchTerm) && 
                        !merchantName.includes(searchTerm)) {
                        return false;
                    }
                }

                // Ø§Ù„ÙØ¦Ø©
                if (categoryId && product.categoryId !== categoryId) {
                    return false;
                }

                // Ø§Ù„ØªØ§Ø¬Ø±
                if (merchantId && product.userId !== merchantId) {
                    return false;
                }

                return true;
            });

            displayProducts(filtered);
        }

        // ==========================================
        // ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ„Ø§ØªØ±
        // ==========================================
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('merchantFilter').value = '';
            
            const activeProducts = filterActiveProducts(allProducts);
            displayProducts(activeProducts);
            
            showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ„Ø§ØªØ±', 'success');
        }

        // ==========================================
        // ğŸ“¤ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function openShareModal(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            currentProductForShare = product;
            prepareShareData(product);
            document.getElementById('shareModal').classList.add('active');
        }

        // ==========================================
        // ğŸ“ ØªØ­Ø¶ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function prepareShareData(product) {
            const merchant = allMerchants.find(m => m.id === product.userId);
            const category = allCategories.find(c => c.id === product.categoryId);
            const imageUrl = formatGoogleDriveUrl(extractProductImage(product));
            
            // ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            document.getElementById('sharePreviewImage').src = imageUrl;
            document.getElementById('sharePreviewImage').alt = product.name || 'Ù…Ù†ØªØ¬';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Øµ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹';
            const productPrice = product.price ? 
                `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²';
            
            const shareText = `ğŸ›ï¸ ${productName} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${productPrice}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø±'}
${category?.name ? `ğŸ“‚ Ø§Ù„ÙØ¦Ø©: ${category.name}` : ''}

${product.description ? `ğŸ“ ${product.description}` : 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„'}

ğŸ”—`;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            currentShareUrl = `${window.location.origin}${window.location.pathname}?productId=${product.id}`;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ±
            document.getElementById('sharePreviewText').textContent = shareText;
            document.getElementById('sharePreviewUrl').value = currentShareUrl;
            
            // ØªØ­Ø¯ÙŠØ« Open Graph Tags Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            updateOpenGraphTagsForProduct(product, imageUrl);
        }

        // ==========================================
        // ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« Open Graph Tags Ù„Ù„Ù…Ù†ØªØ¬
        // ==========================================
        function updateOpenGraphTagsForProduct(product, imageUrl) {
            const title = product.name || 'Ù…Ù†ØªØ¬ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const description = product.description || 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const url = `${window.location.origin}${window.location.pathname}?productId=${product.id}`;
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Open Graph
            document.getElementById('og-title').setAttribute('content', title);
            document.getElementById('og-description').setAttribute('content', description);
            document.getElementById('og-image').setAttribute('content', imageUrl);
            document.getElementById('og-url').setAttribute('content', url);
            
            // ØªØ­Ø¯ÙŠØ« Twitter Card
            document.getElementById('twitter-title').setAttribute('content', title);
            document.getElementById('twitter-description').setAttribute('content', description);
            document.getElementById('twitter-image').setAttribute('content', imageUrl);
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
            document.title = title;
            
            console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Open Graph Tags:', { 
                title, 
                description, 
                image: imageUrl,
                url 
            });
        }

        // ==========================================
        // ğŸ·ï¸ ØªØ­Ø¯ÙŠØ« Open Graph Tags Ø§Ù„Ø¹Ø§Ù…Ø©
        // ==========================================
        function updateOpenGraphTags() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (productId) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø¹Ø±Ù Ù…Ù†ØªØ¬ØŒ Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ«Ù‡ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬
                return;
            }
            
            // Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            const defaultImage = 'https://raw.githubusercontent.com/e772299420-hue/Call/main/icon-512x5122.png';
            const defaultTitle = 'AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„ - Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª';
            const defaultDescription = 'Ø´Ø§Ø±Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const defaultUrl = window.location.href;
            
            document.getElementById('og-title').setAttribute('content', defaultTitle);
            document.getElementById('og-description').setAttribute('content', defaultDescription);
            document.getElementById('og-image').setAttribute('content', defaultImage);
            document.getElementById('og-url').setAttribute('content', defaultUrl);
        }

        // ==========================================
        // ğŸ“‹ Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        // ==========================================
        function copyShareLink() {
            if (!currentShareUrl) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· Ù„Ù„Ù†Ø³Ø®', 'error');
                return;
            }

            navigator.clipboard.writeText(currentShareUrl)
                .then(() => {
                    const btn = document.querySelector('.btn-copy');
                    const originalHTML = btn.innerHTML;
                    
                    btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                    
                    setTimeout(() => {
                        btn.innerHTML = originalHTML;
                    }, 2000);
                    
                    showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
                })
                .catch(err => {
                    console.error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø³Ø®:', err);
                    showNotification('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'error');
                });
        }

        // ==========================================
        // ğŸ“¤ ÙØªØ­ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ Facebook
        // ==========================================
        function openFacebookShare() {
            if (!currentShareUrl || !currentProductForShare) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }

            const product = currentProductForShare;
            const productName = product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹ Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„';
            const facebookGroupUrl = 'https://facebook.com/groups/1650698542573379/';
            
            // Ø±Ø§Ø¨Ø· Ù…Ø´Ø§Ø±ÙƒØ© Facebook
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentShareUrl)}&quote=${encodeURIComponent(productName)}&hashtag=%23AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„`;
            
            window.open(shareUrl, '_blank', 'width=700,height=600');
            
            document.getElementById('shareModal').classList.remove('active');
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ Facebook Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'success');
        }

        // ==========================================
        // ğŸ“± ÙØªØ­ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ù„Ù‰ WhatsApp
        // ==========================================
        function openWhatsAppShare() {
            if (!currentShareUrl || !currentProductForShare) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }

            const product = currentProductForShare;
            const merchant = allMerchants.find(m => m.id === product.userId);
            
            const message = `ğŸ›ï¸ ${product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹'} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${product.price ? `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²'}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø±'}

ğŸ“ ${product.description || 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„'}

ğŸ”— ${currentShareUrl}

#AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„ #ØªØ³ÙˆÙ‚`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            window.open(whatsappUrl, '_blank');
            
            document.getElementById('shareModal').classList.remove('active');
            showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ WhatsApp Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'success');
        }

        // ==========================================
        // ğŸ¯ ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ù…Ù†ØªØ¬ Ù…ÙØ±Ø¯
        // ==========================================
        async function loadAndDisplaySingleProduct(productId) {
            try {
                // Ø¥Ø®ÙØ§Ø¡ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                document.getElementById('allProductsView').style.display = 'none';
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬
                let product = allProducts.find(p => p.id === productId);
                
                if (!product) {
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Firebase Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø­Ù…Ù„Ø§Ù‹
                    const productSnap = await db.ref(`products/${productId}`).once('value');
                    if (productSnap.exists()) {
                        product = { id: productId, ...productSnap.val() };
                    } else {
                        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                        const productsSnap = await db.ref("products").once("value");
                        allProducts = convertFirebaseData(productsSnap.val()) || [];
                        product = allProducts.find(p => p.id === productId);
                    }
                }
                
                if (!product) {
                    showError('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                    return;
                }
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ¬Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙˆÙ†ÙˆØ§ Ù…Ø­Ù…Ù„ÙŠÙ†
                if (allMerchants.length === 0) {
                    const merchantsSnap = await db.ref("merchants").once("value");
                    allMerchants = convertFirebaseData(merchantsSnap.val()) || [];
                }
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¦Ø§Øª Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø­Ù…Ù„Ø©
                if (allCategories.length === 0) {
                    const categoriesSnap = await db.ref("categories").once("value");
                    allCategories = convertFirebaseData(categoriesSnap.val()) || [];
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
                displaySingleProduct(product);
                
                // ØªØ­Ø¯ÙŠØ« Open Graph Tags
                const imageUrl = formatGoogleDriveUrl(extractProductImage(product));
                updateOpenGraphTagsForProduct(product, imageUrl);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬:', error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬');
            }
        }

        // ==========================================
        // ğŸ¨ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
        // ==========================================
        function displaySingleProduct(product) {
            const merchant = allMerchants.find(m => m.id === product.userId);
            const category = allCategories.find(c => c.id === product.categoryId);
            const imageUrl = formatGoogleDriveUrl(extractProductImage(product));
            const price = product.price ? 
                `${parseFloat(product.price).toLocaleString('ar-EG')} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 
                'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù†ØªØ¬
            document.getElementById('singleProductImage').src = imageUrl;
            document.getElementById('singleProductImage').alt = product.name || 'Ù…Ù†ØªØ¬';
            document.getElementById('singleProductTitle').textContent = product.name || 'Ù…Ù†ØªØ¬ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…';
            document.getElementById('singleProductPrice').textContent = price;
            document.getElementById('singleProductDescription').textContent = product.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ù†ØªØ¬';
            
            if (merchant) {
                document.getElementById('merchantName').textContent = merchant.name || merchant.username || 'ØªØ§Ø¬Ø±';
                document.getElementById('merchantLocation').textContent = merchant.governorate || merchant.city || '';
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…ÙØ±Ø¯
            document.getElementById('singleProductView').style.display = 'block';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡ÙŠØ¯Ø±
            document.getElementById('mainHeader').innerHTML = `
                <div class="brand-section">
                    <img src="${imageUrl}" 
                         alt="${product.name || 'Ù…Ù†ØªØ¬'}" 
                         class="brand-logo">
                    <div class="brand-text">
                        <h1>${product.name || 'Ù…Ù†ØªØ¬'}</h1>
                        <p>Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ ÙˆÙˆØ§ØªØ³Ø§Ø¨</p>
                    </div>
                </div>
            `;
        }

        // ==========================================
        // ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø­Ø§Ù„ÙŠ
        // ==========================================
        function shareCurrentProduct(platform) {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('productId');
            
            if (!productId) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©', 'error');
                return;
            }
            
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showNotification('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }
            
            const shareUrl = `${window.location.origin}${window.location.pathname}?productId=${productId}`;
            const merchant = allMerchants.find(m => m.id === product.userId);
            
            if (platform === 'facebook') {
                const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹')}&hashtag=%23AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„`;
                window.open(facebookUrl, '_blank', 'width=700,height=600');
                showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ Facebook Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'success');
            } else if (platform === 'whatsapp') {
                const message = `ğŸ›ï¸ ${product.name || 'Ù…Ù†ØªØ¬ Ø±Ø§Ø¦Ø¹'} ğŸ›ï¸

ğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${product.price ? `${product.price} ${product.currency || 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ'}` : 'Ø³Ø¹Ø± Ù…Ù…ÙŠØ²'}
ğŸª Ø§Ù„ØªØ§Ø¬Ø±: ${merchant?.name || merchant?.username || 'ØªØ§Ø¬Ø±'}

ğŸ“ ${product.description || 'Ù…Ù†ØªØ¬ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† AZ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„'}

ğŸ”— ${shareUrl}

#AZ_Ø§Ù„Ø³ÙˆÙ‚_Ø§Ù„Ø´Ø§Ù…Ù„ #ØªØ³ÙˆÙ‚`;
                
                const encodedMessage = encodeURIComponent(message);
                const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
                window.open(whatsappUrl, '_blank');
                showNotification('Ø¬Ø§Ø±Ù ÙØªØ­ WhatsApp Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©...', 'success');
            }
        }

        // ==========================================
        // ğŸ”” Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        // ==========================================
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ==========================================
        // âŒ Ø¹Ø±Ø¶ Ø®Ø·Ø£
        // ==========================================
        function showError(message) {
            const container = document.getElementById('productsContainer');
            container.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-exclamation-triangle fa-4x" style="color: #e74c3c; margin-bottom: 20px;"></i>
                    <h3 style="color: #c0392b;">Ø­Ø¯Ø« Ø®Ø·Ø£</h3>
                    <p style="color: #7f8c8d;">${message}</p>
                    <button onclick="location.reload()" style="padding: 12px 30px; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 20px;">
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
                    </button>
                </div>
            `;
        }

        // ==========================================
        // ğŸŒ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
        // ==========================================
        window.openShareModal = openShareModal;
        window.shareCurrentProduct = shareCurrentProduct;
        window.copyShareLink = copyShareLink;
        window.openFacebookShare = openFacebookShare;
        window.openWhatsAppShare = openWhatsAppShare;
        window.applyFilters = applyFilters;
        window.resetFilters = resetFilters;

        console.log('ğŸ‰ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ù†Ø¬Ø§Ø­');
    </script>
</body>
    </html>
